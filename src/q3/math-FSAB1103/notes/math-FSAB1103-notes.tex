\documentclass[fr, usereportclass]{../../../eplnotes}

\usepackage[SIunits]{../../../eplunits}

\usepackage{pgfplots}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage[frenchb]{babel}

\hypertitle{math-FSAB1103}{3}{FSAB}{1103}
{Jean-Martin Vlaeminck} % narcissique ? Pas vraiment
{Jean-François Remacle, Grégoire Winckelmans et Roland Keunings}[
\paragraph{Remarque importante}
Ce document a été conçu sur base du syllabus sur les équations aux dérivées partielles, et sur les cours magistraux donnés lors de l'année académique 2016-2017. Il a pour objectif de couvrir l'ensemble de la matière utile pour les cours et pour les examens, et d'être plus facile à lire que le syllabus officiel.
]

\newcommand{\fnpart}[3]{\frac{\partial^{#3} #1}{\partial #2^{#3}}}
\theoremstyle{definition}
\newtheorem{defn}{Définition}[section] % mydef
\newtheorem{thm}{Théorème}[section] % mytheo
\newtheorem{lemme}[thm]{Lemme} % mylem
\newtheorem{propriete}[thm]{Propriété} % myprop
\newtheorem{exemple}{Exemple} % myexem

% commandes :
% \fpart{u}{x} donne du/dx avec des partial
% \ffpart{u}{x} donne d^2 u/dx^2 (partial)
% \fdpart{u}{x}{y} donne d^2 u/dx dy (partial)
% \fdif{u}{x} donne du/dx avec des d droits
% \ffdif{u}{x} donne d^2 u/dx^2 (d droits)
% \dif{t} donne dt
% \divn{V} donne la divergence de V
% \rotn{V} donne le rotationnel de V
% \grad{V} donne le gradient
% \lap{V} donne le laplacien

\part{Équations aux dérivées partielles (EDP)}

\chapter*{Introduction et définitions}

Soit une fonction scalaire $u$, dépendant de $m$ variables $x_1, x_2, \ldots, x_m$. Une relation $\mathcal{F}$ entre $u$, les variables $x_i$ et les dérivées partielles de $u$ par rapport à ces variables,
\[ \mathcal{F} \left( u, x_1, \ldots, \fpart{u}{x_1}, \ldots, \ffpart{u}{x_1}, \ldots, \fdpart{u}{x_1}{x_2}, \ldots, \fnpart{u}{x_1}{n} \right) = 0\]
définit une \emph{équations aux dérivées partielles} d'ordre $n$.

La résolution d'une telle équation dépend de plusieurs facteurs et de plusieurs caractéristiques de l'équation, dont l'ordre de l'équation ($n$), sa (non-)linéarité, son homogénéité et encore d'autre facteurs.

\emph{L'ordre} d'une EDP est l'ordre de la dérivée partielle dont l'ordre est la plus élevée. Par exemple, $\fpart{u}{x} + \fdpart{u}{y}{x} -u^3=0$ est d'ordre $2$.

L'équation suivante, avec $A, B, C, D$ et $F$ des fonctions de $x$, $y$ et $u$
\begin{equation}
\label{eq:intro-exemple1}
 A \ffpart{u}{x} + B \fdpart{u}{x}{y} + C \ffpart{u}{y} + Du = F
\end{equation}
est une équation d'ordre 2, à deux variables ; $m=2$ et $n=2$ (mais ce n'est pas le cas en général). Les fonctions $A, B, C, D, F$ sont les coefficients des dérivées partielles. S'il s'agit de fonctions constantes, on parle d'\emph{EDP à coefficients constants}.

Une EDP est dite \emph{linéaire} quand elle l'est par rapport à $u$ et à toutes ses dérivées partielles. Par exemple, si les fonctions $A, B, C, D, F$ de l'équation précédente \ref{eq:intro-exemple1} sont des fonctions de $x$ et $y$, mais pas de $u$ ou d'une de ses dérivées partielles, alors l'équation est linéaire. Une propriété importante des équations linéaires est le \emph{principe de superposition} : si $u(x, y)$ et $v(x, y)$ sont solutions de l'équation, alors toute combinaison linéaire de $u$ et $v$ est aussi solution ; c'est d'ailleurs une manière de vérifier la (quasi)-linéarité.

Une EDP est dite \emph{quasi-linéaire} quand elle est linéaire par rapport aux dérivées partielles d'ordre le plus élevé en chacune des variables, c'est-à-dire que les coefficients devant les dérivées partielles d'ordre les plus élevés ne dépendent pas de $u$. Les équations quasi-linéaire se résolvent avec des techniques fort similaires aux techniques utilisées pour les équations linéaires. Elles sont très fréquentes en physique, bien plus que les équations linéaires, et obéissent aux mêmes schémas de \emph{stabilité} numériques que les équations linéaires. Parfois, elles peuvent être écrites sous une forme que l'on qualifie de \emph{forme conservative}.

Une EDP est dite \emph{homogène} quand elle ne contient que des termes ne faisant intervenir $u$ ou ses dérivées partielles. Par exemple, l'équation \ref{eq:intro-exemple1} est homogène si $F=0$. Une équation homogène admet toujours la solution nulle $u=0$. Une EDP linéaire mais non-homogène a comme solution générale la somme d'une solution particulière de l'équation non-homogène et de la solution générale de l'équation homogène correspondante, tout comme leurs cousins EDO.

Enfin, la solution d'une équation aux dérivées partielles, $u=f(x_1, \ldots, x_m)$, est qualifiée de \emph{surface intégrale} ou simplement une intégrale de l'EDP.

Terminons cette introduction par une remarque importante : toutes les équations que l'on va voir dans ce cours ont une interprétation physique. Cela a des conséquences sur les unités présentes dans les équations (comme on verra dans la section suivante) et cela implique également que les solutions que l'on recherche ont une valeur finie en n'importe quel point (pas de singularité, comme une valeur infinie au milieu du domaine) et qu'elles diminuent et approchent de zéro lorsqu'on s'éloigne de la région d'intérêt : la solution tend vers $0$ quand la position $(x, y, z)$ tend vers l'infini, ou $\lim\limits_{(x, y, z)\rightarrow\infty} u = 0$.

\section{Quelques exemples, et une remarque concernant les unités}

Afin de mieux comprendre les différents types d'EDP, le mieux est de s'attarder sur quelques exemples, parfois notables.

\[ \ffpart{u}{x} + \ffpart{u}{y} = 0\]
est une EDP à deux variables, d'ordre $2$, linéaire (l'opérateur de dérivation est linéaire), à coefficients constants, et homogène (le membre de droite est nul, et la solution $u=0$ satisfait l'équation). Il s'agit de l'\emph{équation de Laplace}.

\[ x \fpart{u}{x} + y \fpart{u}{y} + \frac{xy}{l^2} u=2u_0 \]
est une équation d'ordre $1$, linéaire (vérifiez !), à coefficients non constants (ce sont des fonctions) et non homogène (le membre de droite est supposé non nul). La présence de la constante $l$ n'est pas anodin : dans le cadre de ce cours, toutes les équations que l'on voit ont une interprétation physique, et ont donc des dimensions et des unités. Ici, $x$ et $y$ ont des unités d'une longueur, et donc $l$ doit avoir les unités d'une longueur également. De même, $u_0$ doit avoir les mêmes dimensions que $u$ (température, pression, chaleur, \ldots).

\[ \left(\fpart{u}{y}\right)^2 \ffpart{u}{x} + \left(\fpart{u}{x}\right)^2 \ffpart{u}{y} = 0 \]
est une équation d'ordre $2$, homogène, non linéaire (à cause des carrés), mais bien quasi-linéaire. En effet, les dérivées partielles d'ordre 2 sont des fonctions linéaires (elles ne sont pas élevées au carré, prises dans un logarithme ou dans un sinus, \ldots) ; le fait que le coefficient de ces dérivées d'ordre 2 dépendent de $u$, voire même de $\fpart{u}{x}$ au carré, ne change pas le fait qu'elle est linéaire.

\[ \fpart{u}{y} \ffpart{u}{x} + \frac{1}{l} \left(\fpart{u}{x}\right)^2 +\fpart{u}{x} \ffpart{u}{y} = 0\]
est également d'ordre $2$, homogène et quasi linéaire (seuls les dérivées d'ordre 2 comptent).

\[ \frac{1}{l} \left(\fpart{u}{x}\right)^2 + \fpart{u}{x} \ffpart{u}{y} = 0 \]
est d'ordre $2$, homogène, mais pas quasi linéaire. En effet, elle est linéaire par rapport à la dérivée partielle la plus élevée en $y$ (qui est $\ffpart{u}{y}$), mais pas par rapport à celle en $x$, qui est $\fpart{u}{x}$.

\[ c \fpart{u}{x} + \fpart{u}{t} = 0 \]
est une EDP à deux variables (une spatiale, $x$, et une temporelle, $t$), d'ordre $1$, linéaire, à coefficients constants si $c$ est une constante, et homogène. L'EDP reste linéaire si $c$ est une fonction de $x$ et/ou de $t$, mais n'est plus linéaire (mais quasi-linéaire) si $c$ est une fonction de $u$. C'est l'\emph{équation de transport}.

\[ u \fpart{u}{x} + \fpart{u}{t} = 0 \]
est une EDP d'ordre $1$, quasi linéaire et homogène. C'est l'\emph{équation de Burgers}, qui peut aussi s'écrire sous une forme dite conservative,
\[ \fpart{}{x} \left( \frac{u^2}{2} \right) + \fpart{u}{t} = 0 \]

\[ \fpart{}{x} \left( \alpha(u) \fpart{u}{x} \right) - \fpart{u}{t} = 0 \]
est, enfin, une EDP d'ordre 2, quasi-linéaire (ceci peut être vérifié en développant l'équation par la règle du produit) et homogène. Si $\alpha(u) > 0$, il s'agit de l'équation de diffusion, avec $\alpha$ le coefficient de diffusivité.

\chapter{EDP d'ordre 1}

Commençons donc par résoudre les EDP du 1er ordre. Ces EDP sont dites \emph{à caractère hyperbolique} (on verra plus loin ce que cela signifie). Les équations que nous allons voir dépendent de deux paramètres, $x$ et $y$ (équation dans un plan 2D, indépendante du temps) ou $x$ et $t$ (équation en 1D dépendante du temps), et on a donc, en reprenant les notations de l'introduction, $n=1$ et $m=2$. Dans la suite, on utilisera $x$ et $y$.

Les EDP du 1er ordre quasi linéaires ont la forme
\begin{equation}
\label{eq:order1-genequa}
P \fpart{u}{x} + Q \fpart{u}{y} = R
\end{equation}
avec $P, Q, R$ des fonctions qui dépendent, au plus, de $x$, $y$ et $u$ (elles ne peuvent pas dépendre des dérivées partielles, sinon l'équation ne serait plus linéaire). $R$ peut toujours être écrit sous la forme $R(x, y, u) = F(x, y) + H(x, y, u)$. L'équation sera homogène si $F=0$\footnote{Et très probablement, si $G$ est une fonction linéaire en $u$.}.

Les EDP du 1er ordre linéaires ont presque la même forme, à savoir
\[ P \fpart{u}{x} + Q \fpart{u}{y} + Gu = F \]
où $P, Q, F$ et $G$ sont des fonctions de $x$ et/ou de $y$, mais pas de $u$. Et l'équation est homogène si $F=0$ (dans ce cas, $u=0$ est bien solution). La principale différence entre les EDP quasi-linéaires et linéaires vient du fait que la fonction $R$ s'écrit $R(x, y, u) = F(x, y) - G(x, y)\cdot u$, avec $H(x, y, u) = G(x, y) \cdot u$ ; la fonction $H$ est bien linéaire en $u$.

La solution de cette EDP, notée $u(x, y)$, est alors une surface dans l'espace de dimension 3. Cette surface peut être décrite à partir d'une relation explicite ($u(x, y)$) ou à partir d'une relation implicite ($\mathcal{F}(x, y, u)=0$). Dans la suite, nous considérerons surtout les équations non nécessairement homogènes.

\section{Méthode des caractéristiques}

Une EDP seule n'est pas résoluble De la même manière qu'il faut, dans le cas des équations différentielles ordinaires, donner un certain nombre de conditions afin d'obtenir une solution unique, il va falloir donner une sorte de condition initiale afin de pouvoir résoudre le problème. Cette condition initiale sera, dans le cas des EDP à deux variables, une courbe paramétrée $\Gamma(s) \equiv (x(s), y(s))$ sur laquelle on donne la valeur de $u$ : $u(x(s), y(s)) = f(s)$. Le problème de déterminer $u$ sur l'ensemble du domaine, à partir de la connaissance de l'EDP et de la connaissance de la valeur de $u$ sur la courbe $\Gamma$ (nommé \emph{arc de Cauchy}), constitue le \emph{problème de Cauchy}.

Pour résoudre les EDP du 1er ordre, une méthode particulièrement utile et puissance est la \emph{méthode des caractéristiques}. Le principe de cette méthode est la suivante : comme nous connaissons la valeur de $u$ sur $\Gamma$, ainsi que la variation de $u$ dans un voisinage de $\Gamma$ (grâce à l'EDP), il doit être possible de déterminer $u$ dans un voisinage de $\Gamma$, et d'appliquer à nouveau ce principe pour déterminer $u$ en n'importe quel point. On détermine donc $u(x, y)$ de proche en proche, en partant de la courbe $\Gamma$ et en utilisant l'équation différentielle pour obtenir les solutions intermédiaires entre $\Gamma$ et $(x, y)$, ce qui nous permet alors de bien calculer $u$.

Tout le problème devient à présent de déterminer s'il est possible, et à quelles conditions, de déterminer $u$ dans un voisinage d'une courbe, étant donné l'EDP. De même, nous aimerions une méthode générique, dépendant le moins possible de la courbe $\Gamma$ donnée, et de la valeur de $u$ sur cette courbe (la fonction $f(s)$, généralement donnée). Voyons donc ce que l'on peut faire.

Tout d'abord, comme $u(x(s), y(s))=f(s)$ est connu sur la courbe de Cauchy, la dérivée partielle de $u$ par rapport au paramètre $s$ est également connu (c'est $f'(s)$), et donc\footnote{Pour ceux qui se le demanderaient, l'utilisation de la notation avec $\partial$ dans les dérivées partielles est généralement utilisée quand la fonction dépend de plusieurs variables. Si la fonction est à une seule variable, on utilise généralement $\mathrm{d}$ à la place de $\partial$.}

\begin{equation}
f'(s) = \fdif{u}{s} = \fpart{u}{x} \cdot \fdif{x}{s} + \fpart{u}{y} \cdot \fdif{y}{s}
\end{equation}

C'est une équation supplémentaire qui relie $\fpart{u}{x}$ et $\fpart{u}{y}$ ; on peut donc écrire cette équation, avec notre EDP (équation \ref{eq:order1-genequa}), le système
\begin{equation}
\label{eq:order1-bienpose}
\begin{pmatrix}
P & Q \\
\fdif{x}{s} & \fdif{y}{s} \\
\end{pmatrix}
\begin{pmatrix}
\fpart{u}{x} \\
\fpart{u}{y} \\
\end{pmatrix}
= \begin{pmatrix}
R \\
\fdif{u}{s} = f'(s) \\
\end{pmatrix}
\end{equation}

Dans ce système, les fonctions $P$, $Q$, $R$, les dérivées $\fdif{x}{s}$, $\fdif{y}{s}$ et $f'(s)=\fdif{u}{s}$ sont toutes connues. Si le déterminant est non nul, on peut alors toujours déterminer les dérivées partielles $\fpart{u}{x}$ et $\fpart{u}{y}$, et donc déterminer la valeur de $u$ un peu à côté de notre point de référence sur $\Gamma$ ; en effet, du cours de maths 2, on sait que
\[ u(x+\dif{x}, y+\dif{y}) = u(x, y) + \fpart{u}{x}(x, y) \dif{x} + \fpart{u}{y}(x, y) \dif{y} \]

On peut donc déterminer $u$ un peu plus loin de $\Gamma$, et réitérer le processus afin de déterminer $u$ au point qui nous intéresse. Sauf que ce système, et donc cette relation, n'est valable que sur $\Gamma$, ou sur une courbe paramétrée sur laquelle on connait $u$, ce qui n'est pas pratique. Il faut donc trouver une meilleure manière de déterminer cette \og propagation \fg{} de la solution.

Cette méthode ne fonctionne que si le déterminant ne s'annule pas. Si le déterminant s'annule, il est impossible de déterminer les dérivées partielles, et toute la résolution s'écroule. On dira que \emph{le problème de Cauchy est \strong{bien posé}} si le déterminant du système ne s'annule en aucun des points de la courbe. Il est donc important, lorsqu'on pose un problème de Cauchy, de spécifier $\Gamma$ de telle sorte que le problème résultant soit bien posé.

Voyons maintenant ce qu'il se passe si on tente de propager l'équation selon une direction $(\dif{x}, \dif{y})$. Cette direction doit, bien évidemment, être non parallèle à la courbe (sinon on n'avance pas). Autrement dit,
\[ (\dif{x}, \dif{y}) \neq \alpha (\fdif{x}{s}, \fdif{y}{s}) \quad \alpha \in \mathrm{R} \]
La variation de $u$, le long de cette direction, est égale à
\[ \fpart{u}{x} \dif{x} + \fpart{u}{y} \dif{y} = \dif{u} \]
De nouveau, on peut former un nouveau système avec notre EDP,
\begin{equation}
\label{eq:order1-dirpart}
\begin{pmatrix}
P & Q \\ \dif{x} & \dif{y} \\
\end{pmatrix}
\begin{pmatrix}
\fpart{u}{x} \\ \fpart{u}{y} \\
\end{pmatrix}
= \begin{pmatrix}
R \\ \dif{u} \\
\end{pmatrix}
\end{equation}
Afin de simplifier les calculs, nous allons choisir $\dif{x}$ et $\dif{y}$ tels que le déterminant de cette équation s'annule. Cela correspond à une direction particulière, où le calcul de la propagation de $u$ est plus simple. Plus précisément, il s'agit d'une direction telle que
\begin{equation}
\label{eq:order1-caractode}
P\dif{y} = Q \dif{x}
\end{equation}
soit $\frac{P}{Q} = \frac{\dif{x}}{\dif{y}}$, ou encore $(\dif{x}, \dif{y}) \propto (P, Q)$ ; la direction $(\dif{x}, \dif{y})$ est, en quelque sorte, parallèle à la direction définie par $P$ et $Q$.

Le système \ref{eq:order1-dirpart} ne doit pas être confondu avec le système \ref{eq:order1-bienpose}. Ce dernier exprime une condition sur $\Gamma$, telle que le problème est bien posée ; tandis que le système \ref{eq:order1-dirpart} permet de déterminer une direction locale intéressante, parallèle à $(P, Q)$. Cette direction n'est jamais parallèle à la direction de la courbe de Cauchy ; si tel était le cas, le déterminant de \ref{eq:order1-bienpose} serait nul, et le problème serait mal posé\footnote{
	Si $(\dif{x}, \dif{y}) = k \cdot (\fdif{x}{s}, \fdif{y}{s})$, autrement dit s'ils sont parallèles, alors le déterminant de \ref{eq:order1-bienpose} devient \[ \begin{vmatrix} P & Q \\ \fdif{x}{s} & \fdif{y}{s} \\ \end{vmatrix} = \frac{1}{k} \begin{vmatrix} P & Q \\ \dif{x} & \dif{y} \\ \end{vmatrix} =0 \] et donc, le problème serait déjà mal posé à la base.}.

Si le problème est bien posé, alors cette direction particulière n'est jamais parallèle à la courbe $\Gamma$, et définit, en tout point du plan, ce que l'on appelle la \emph{direction caractéristique}. Et en suivant, à partir d'un point donné de $\Gamma$, les différentes directions caractéristiques, on obtient la \emph{courbe caractéristique} : une courbe qui suit, qui est tangente à la direction caractéristique en tout point. On obtient donc, à partir de l'équation $P\dif{y} = Q\dif{x}$, un \emph{réseau de courbes caractéristiques}.

Chaque courbe caractéristique doit croiser une seule fois la courbe de Cauchy $\Gamma$, pour que le problème soit bien posé ; en effet, la courbe caractéristique issue d'un point $P$ sur $\Gamma$ va nous permettre de calculer $u$ sur l'ensemble des points de cette caractéristique. Il est donc important que la courbe caractéristique ne croise qu'une seule fois la courbe de Cauchy ; sinon, on imposerait plusieurs conditions sur cette courbe, ce qui donne généralement des incompatibilités.

Comment obtenir l'équation d'une des courbes caractéristiques ? En intégrant la direction caractéristique, depuis un point de $\Gamma$ $(x(s), y(s))$ jusqu'à un point $(x, y)$. Plus précisément\footnote{Dans cette équation, $P'$ et $Q'$ sont deux fonctions, dépendant uniquement respectivement de $y$ et de $x$ ; elles peuvent obtenues à partir de $P(x, y)$ et $Q(x, y)$ en isolant $x$ et $y$ de chaque côté. Les variables $x'$ et $y'$ sont les mêmes que $x$ et $y$, mais ces symboles sont déjà utilisées dans les bornes de l'intégrale.} :
\begin{equation}
\label{eq:order1-caractcurve_integral}
\begin{split}
P \dif{y} &= Q \dif{x} \\
\int_{x(s)}^{x} P'(y') \dif{y'} &= \int_{y(s)}^{y} Q'(x') \dif{x'}
\end{split}
\end{equation}
L'idée est que, pour déterminer les points $x$ et $y$ qui seront atteignables par la caractéristique issue d'un point de la courbe de Cauchy en $(x(s), y(s))$ pour un $s$ donné, on va suivre et intégrer la direction caractéristique, et donc parcourir la courbe, depuis ce point de la courbe de Cauchy jusqu'à un point $(x, y)$ que l'on suppose appartenir à la caractéristique. Cela donne donc une relation entre $x$ et $y$ pour un $s$ donné, et également une relation qui donne $s$ en fonction de $x$ et $y$. $s$ est une constante dans cette relation, et paramétrise la courbe : pour un $s$ donné, on obtient une courbe caractéristique précise.

Maintenant que l'on connait une direction caractéristique, comment peut-on propager notre solution $u$ le long de cette caractéristique ? Tout simplement en utilisant le système \ref{eq:order1-dirpart}. Comme le déterminant principal s'annule, la seule manière d'avoir encore une solution est que le déterminant formé en remplaçant une colonne de la matrice principale, par la colonne des termes indépendants, s'annule également (un peu à la Kramer). C'est-à-dire :
\[ \begin{vmatrix} P & R \\ \dif{x} & \dif{u} \\ \end{vmatrix} = 0 \quad \quad \begin{vmatrix} R & Q \\ \dif{u} & \dif{y} \\ \end{vmatrix} = 0 \]
\begin{equation}
\label{eq:order1-compatode}
\Leftrightarrow P\dif{u} = R\dif{x} \quad \quad Q\dif{u} = R\dif{y}
\end{equation}

Les deux relations obtenues sont des \emph{relations de compatibilité}, ou relations caractéristiques ; elles définissent le comportement de $u$ qui est compatible avec la direction, et donc la courbe, caractéristique. Elles permettent de relier $\dif{u}$ à la variation $\dif{x}$ le long de la caractéristique. Or, ces relations sont des équations différentielles ordinaires ; notre EDP est donc devenue une EDO le long de chaque caractéristique, ce qui est beaucoup plus simple à résoudre.

Désormais, pour déterminer $u$ à un point $A$ donné, il ne reste plus qu'à intégrer la relation de compatibilité le long de la caractéristique, depuis un point $B$ sur la courbe de Cauchy (où l'on connait $u$) jusqu'à notre point $A$\footnote{Le point $B$ peut être déterminé, vu que s'il y a une caractéristique qui passe par $A$, alors cette caractéristique croise une seule fois la courbe de Cauchy. Il est néanmoins possible que l'on ne puisse pas calculer $u$ à un certain point, si la courbe de Cauchy ou si les caractéristiques empêchent la propagation de $u$ en ce point : caractéristiques absentes, $\Gamma$ trop courte.}.

Il est à noter qu'une seule des deux relations de compatibilité est nécessaire pour l'intégration ; l'autre relation peut directement être obtenue à partir de l'une et de \ref{eq:order1-caractode}. Une manière de retenir ces relations est
\begin{equation}
\label{eq:order1-diffeqnmemo}
\frac{\dif{x}}{P} = \frac{\dif{y}}{Q} = \frac{\dif{u}}{R}
\end{equation}
Néanmoins, comme $P$, $Q$ ou $R$ peuvent s'annuler, il vaut mieux revenir à la forme normale de ces équations lors de l'intégration. C'est essentiellement un moyen mnémotechnique. De même, il vaut mieux choisir la relation la plus simple à intégrer.

Une relation supplémentaire qui peut être utile est $\sqrt{P^2+Q^2} \dif{u} = R\dif{l}$ ; celle-ci relie la variation de $u$ avec la variation $\dif{l}$ directement le long de la caractéristique (dans l'axe de la caractéristique), de sorte que $\dif{l}^2 = \dif{x}^2 + \dif{y}^2$. La démonstration est simplement une règle de la chaine sur $\fdif{u}{l}$, avec quelques manipulations à partir des relation \ref{eq:order1-diffeqnmemo}.

Le cas où $R=0$ donne $\dif{u}=0$ le long de la caractéristique : $u$ est alors constant le long de la caractéristique. On appelle ça un \emph{invariant de Riemann}.

Les EDP du 1\ier{} ordre (avec des fonctions réelles) ont toutes la propriété d'être \emph{à caractère hyperbolique}. Cette propriété peut être résumée, de manière informelle, par le fait qu'elles ont toutes la particularité de pouvoir être résolues par une sorte de propagation de la solution le long de caractéristiques.

Une dernière remarque avant de passer à des exemples. Une certaine EDP du premier ordre, de la forme de l'équation \ref{eq:order1-genequa}, définit un réseau de caractéristiques, via la relation $P\dif{y}=Q\dif{x}$. L'inverse est aussi vrai : un réseau de caractéristiques définit aussi une unique relation de la forme $P\dif{y}=Q\dif{x}$, et donc une EDP du 1\ier{}. Il y a une bijection entre les EDP du 1\ier{} ordre et les réseaux de caractéristiques, et il faut donc être préparé à travailler dans les deux sens (l'examen de septembre 2016 en est un parfait exemple...).

\section{Exemples}

Afin d'illustrer la méthode des caractéristiques, considérons l'EDP suivante
\[y\fpart{u}{x} - x\fpart{u}{y} = R\]
et la courbe $\Gamma$ définie par $x(s)=s$ et $y(s)=0$, pour $s$ strictement positif (on verra pourquoi). Il s'agit du demi-axe des x strictement positifs. On spécifie sur cette courbe une fonction $f(s)$ donnée (ici, peu importe sa définition).

On commence par déterminer le réseau des caractéristiques. Puisque $P=y$ et $Q=-x$, les caractéristiques sont déterminées par l'intégration suivante (équation \ref{eq:order1-caractcurve_integral}) :
\begin{align*}
P \dif{y} &= Q \dif{x} \\
y \dif{y} &= -x \dif{x} \\
\int_{y(s)}^{y} y' \dif{y'} &= \int_{x(s)}^{x} -x' \dif{x'} \\
\int_{0}^{y} y' \dif{y'} &= \int_{s}^{x} -x' \dif{x'} \\
\frac{y^2}{2} &= \frac{s^2}{2} - \frac{x^2}{2} \\
x^2 + y^2 &= s^2
\end{align*}

Comment interpréter cette intégration ? Nous avons suivi la direction caractéristique depuis un point de $\Gamma$ jusqu'à un point $(x, y)$. Cela donne donc une relation entre $x$ et $y$ pour $s$ donné, et également une relation qui donne $s$ en fonction de $x$ et $y$.

Ici, pour un $s$ donné, la caractéristique n'est rien d'autre que le cercle de rayon $s$ centré à l'origine ; le réseau est donc un ensemble de cercles concentriques. C'est pour ça qu'on a défini la courbe de Cauchy ainsi : la demi-droite ne coupe chaque cercle qu'une seule fois, et n'est pas parallèle à la tangente au cercle. $\Gamma$ est donc admissible et le problème est bien posé.

Ensuite, il ne reste plus qu'à calculer $u$ en chaque point. Pour cela, on utilise une des relations de compatibilité, $P\dif{u} = R\dif{x}$ ou $Q\dif{u}=R\dif{y}$, et on intègre :
\[\int_{u(x(s), y(s))}^{u(x, y)} P \dif{u'} = \int_{x(s)}^{x} R\dif{x'}\]
ou
\[\int_{u(x(s), y(s))}^{u(x, y)} Q \dif{u'} = \int_{y(s)}^{y} R\dif{y'}\]

Considérons le cas où $R=0$. L'équation est alors homogène, et les relations de compatibilité deviennent $\dif{u}=0$ ($P$ et $Q$ ne sont pas nuls en général). Cela signifie que $u$ a la même valeur, partout sur la caractéristique. De fait, si on effectue l'intégrale,
\begin{align*}
\int_{u(x(s), y(s))}^{u(x, y)} P \dif{u'} &= \int_{x(s)}^{x} R\dif{x'} \\
\int_{u(x(s), y(s))}^{u(x, y)} y \dif{u'} &= \int_{x(s)}^{x} 0 \dif{x'} \\
&= 0 \\
\Rightarrow u(x, y) &= u(x(s), y(s))
\end{align*}
Et comme, pour $x$ et $y$ donnés, on a $x^2+y^2=s^2$, on a $s=\sqrt{x^2+y^2}$ et donc,
\[u(x, y) = f(\sqrt{x^2+y^2})\]

Considérons un cas plus complexe, celui où $R=\frac{u_0xy}{l^2}$. On remarque tout de suite la présence du $l^2$ au dénominateur ; celui-ci sert à rendre adimensionnel le produit $xy$, de sorte que $R$ ait les mêmes dimensions que $u_0$ et donc $u$. Les dimensions sont très importantes dans ce cours.

En intégrant l'une des deux relations de compatibilité (par exemple la première), on obtient
\begin{align*}
\int_{u(x(s), y(s))}^{u(x, y)} P \dif{u'} &= \int_{x(s)}^{x} R \dif{x'} \\
\int_{u(x(s), y(s))}^{u(x, y)} y \dif{u'} &= \int_{s}^{x} \frac{u_0x y }{l^2} \dif{x'} \\
\int_{f(s)}^{u(x, y)} 1 \dif{u'} &= u_0 \int_{s}^{x} \frac{x}{l^2} \dif{x'} \\
u(x, y) &= f(\sqrt{x^2+y^2}) + u_0 (\frac{x^2}{2l^2}  \frac{s^2}{2l^2}) \\
&= f(\sqrt{x^2+y^2}) - u_0 \frac{y^2}{2l^2}
\end{align*}
où nous avons utilisé le fait que $x^2+y^2=s^2$, afin d'éliminer $s$ de l'équation.

Considérons enfin le cas $R=u_0$. Il parait bien inoffensif, mais il ne l'est point. De nouveau, on intègre (cette fois avec la deuxième relation) :
\begin{align*}
Q \dif{u} &= R \dif{y} \\
-x \dif{u} &= u_0 \dif{y} \quad \text{ or, } x=\pm \sqrt{s^2-y^2} \\
\dif{u} &= -u_0 \frac{1}{ \pm \sqrt{s^2-y^2}} \dif{y} \\
\int_{u(x(s), y(s))}^{u(x, y)} \dif{u'} &= \int_{y(s)}^{y} -u_0 \frac{1}{\pm \sqrt{s^2-y^2}} \dif{y'} \\
\int_{f(s)}^{u(x, y)} 1 \dif{u'} &= -u_0 \int_{0}^{y} \pm \frac{1}{ \sqrt{s^2-y^2}} \dif{y'} \quad \quad + \text{ si } x>0 \; ; \, - \text{ sinon} \\
u(x, y) - f(s) &= -u_0 \left[ \pm \arcsin(\frac{y}{s}) \right]_{0}^{y}\\
&= \mp u_0 \left( \arcsin(\frac{y}{\sqrt{x^2+y^2}}) - \frac{\pi}{2} \right)
\end{align*}
et donc,
\[
u(x, y) = f(\sqrt{x^2+y^2}) + \begin{cases}
(-u_0) \left( \arcsin(\frac{y}{\sqrt{x^2+y^2}}) - \frac{\pi}{2} \right), & \text{si } x>0 \\
u_0 \left( \arcsin(\frac{y}{\sqrt{x^2+y^2}}) - \frac{\pi}{2} \right), & \text{sinon} \\
\end{cases}
\]
Quelques subtilités se cachent dans cet exemple. Tout d'abord, il faut exprimer $x$ en fonction de $y$ (car nous intégrons par rapport à $y$, et $s$ est une constante sur la caractéristique). Ensuite, il faut tenir compte des deux signes possibles pour $x$, et donc bien définir la fonction.
%TODO : il est possible que j'aie fait une ou deux erreurs

\section{Équation de transport}

Un exemple classique d'EDP du premier ordre, unidimensionnel et dépendant du temps, est \emph{l'équation de transport} (ou équation de convection) :
\begin{equation}
\label{eq:order1-transport-ncgen}
c \fpart{u}{x} + \fpart{u}{t} = 0
\end{equation}
où $c$ a les dimensions d'une vitesse. L'équation de transport se retrouve dans des phénomènes physiques où une certaine quantité se transport dans l'espace, avec une vitesse $c$.

Il s'agit d'une EDP du premier ordre, avec $P=c$, $Q=1$ et $R=0$. La vitesse $c$ est, en toute généralité, une fonction de $x$, $t$ et même $u$. Le cas linéaire de l'EDP nécessite que $c=c(x, t)$ mais que $c$ ne dépende pas de $u$ (sinon, il y aurait un produit entre une fonction de $u$ et une dérivée partielle de $u$, et l'EDP ne serait plus linéaire). Comme $R=0$, $u$ est conservé le long des caractéristiques, qui sont données par intégration de $\dif{x}=c\dif{t}$.

Le domaine de l'équation de transport peut être borné ou non borné (ouvert) : un domaine borné est borné au niveau spatial, il y a des limites pour la valeur de $x$. Pour ce qui est de la \og condition initiale \fg{}\footnote{J'écris cette condition entre guillemets pour la différencier de la \og vraie \fg{} condition initiale, et qui est défini à la ligne d'après.} (la condition sur $u$ que l'on donne sur la courbe de Cauchy), on spécifie généralement $u$ sur la courbe de Cauchy définie par $\Gamma \equiv x(s)=s, t(s)=0$, et on donne $u(s, 0)=f(s)$. C'est alors une \emph{condition initiale}, une condition que l'on spécifie en un temps donné. L'intérêt des conditions initiales est avant tout pratique : lorsqu'on étudie un phénomène physique, on peut généralement déterminer ce phénomène à un instant donné (par des mesures par exemple), et on souhaite ensuite déterminer l'évolution de ce phénomène pour des instants ultérieurs.

Il se fait que quelle que soit la vitesse $c$, une telle condition initiale est bien posée : la direction locale des caractéristiques est donnée par $\frac{\dif{t}}{\dif{x}}=\frac{1}{c}\neq 0$\footnote{Ici, il est bien plus simple d'écrire la direction comme étant une certaine \emph{pente}, afin d'aider l'interprétation.}, tandis que la direction locale de la courbe de Cauchy est $\frac{\dif{x}}{\dif{t}}=0$. Physiquement, si on donne une condition initiale ainsi que la vitesse de déplacement de la quantité étudiée, on peut toujours calculer (parfois difficilement, comme on verra) l'état de cette quantité pour un instant $t>0$, simplement en suivant la vitesse. Le seul cas où une telle détermination est impossible, et où le problème est mal posé, survient quand $c \rightarrow \infty$ : la caractéristique et la courbe de Cauchy sont parallèles et confondues.

Commençons par étudier le cas le plus simple, avec $c$ constant. Dans ce cas, l'intégration des caractéristiques donne
\[ \int_{s}^{x} \dif{x'} = c \int_{0}^{t} \Leftrightarrow x-s=ct\]
et donc, $x(t)=ct+s$ pour un $s$ donné. Les caractéristiques sont des droites parallèles, et on a alors simplement
\[ u(x, t)=f(s)=f(x-ct) \]
La fonction initiale est simplement transportée à une vitesse constante $c$, sans aucune déformation. Mieux, la solution est aussi connue pour des $t$ négatifs : on peut connaitre le passé de la fonction !

Dans le cas $c$ constant, aurait-on pu spécifier une condition limite plutôt qu'une condition initiale ? Une condition limite est une condition sur $u(x, t)$ pour un $x$ fixé : on donne la valeur de $u$ sur une limite du domaine de la fonction (par exemple en $x=0$). Considérons donc $\Gamma' \equiv x(\tau)=0, t(\tau)=\tau$, sur laquelle on spécifie $u(0, \tau)=h(\tau)$, une autre fonction donnée. Cette fois, pour peu que $c\neq 0$, le problème est toujours bien posé : la direction locale de la courbe de Cauchy peut s'écrire comme $\frac{\dif{x}}{\dif{t}}=0$ tandis que la direction locale de la caractéristique est $\frac{\dif{x}}{\dif{t}}=c\neq 0$ (remarquez bien que la fraction a été inversée !). L'intégration des caractéristiques donne cette fois
\[ \int_{0}^{x} \dif{x'} = c \int_{\tau}^{t} \Leftrightarrow x=c(t-\tau) \Leftrightarrow \tau=t-\frac{x}{c}\]
qui sont toujours des droites parallèles, et la solution est donc
\[ u(x, t)=h(\tau)=h \left( t-\frac{x}{c} \right) \]

Si $c=0$, le problème est mal posé, et pour cause : plus rien ne se déplace vu que la vitesse est nulle, ce qui fait qu'une condition limite devient inutile et dangereuse ; inutile car elle ne spécifie pas la fonction $u$ ailleurs que sur la limite, et donc $u$ est inconnue partout ailleurs, et condamnée à ne jamais être connue en raison de la vitesse nulle et des caractéristiques mal orientée ; dangereuse car elle risque de spécifier plusieurs valeurs pour $u$ sur la limite, alors que $u$ n'y varie jamais (car la vitesse est nulle).

Si $c>0$, l'intuition nous dit que la fonction est translatée en direction des $x$ positifs, et les caractéristiques sont des droites dont la pente est positive ; par conséquent, on peut décider de considérer un domaine borné à gauche (on dit aussi semi-borné) $0 \le x < \infty$. Il est alors nécessaire de spécifier deux conditions : une condition initiale de la fonction et $t=0$, qui va nous permettre de calculer $u(x, t)$ $\forall x, t$ tels que $x-ct\ge 0$ (sur un graphique $(x, t)$ avec $x$ en abscisse, ce sont les points en dessous de l'axe $x=ct$, qui est la caractéristique issue de $s=0$), \emph{et} une condition limite en $x=0$, qui va nous permettre de calculer $u$ pour les autres points. Pourquoi deux conditions limites ? Parce que le fait de borner le domaine à gauche \og élimine \fg{} la connaissance de $u$ pour $x<0$, et donc la connaissance de $u$ pour tous les points $(x, t)$ qui appartenaient à une caractéristique pour laquelle $s<0$. Il faut donc retrouver cette connaissance, en spécifiant par exemple une condition en $x=0$, de sorte que les caractéristiques issues de cette condition \og propagent \fg{} la valeur de $u$ sur l'ensemble du domaine. On spécifie alors deux fonctions, $u(s, 0)=f(s)$ pour $s\ge 0$ et $u(0, \tau)=h(\tau)$ pour $\tau>0$, et on sépare la solution en deux cas, par exemple :
\[u(x, t) = \begin{cases}
f(x-ct) & \text{si } x-ct>0 \\
h \left(t-\frac{x}{c} \right) \text{sinon} \\
\end{cases}\]

Pour $c>0$, aurait-on pu décider de spécifier une deuxième condition limite, en $x=L>0$, de sorte que l'on ait un domaine borné à gauche et à droite ? La réponse est non \footnote{Du moins, dans le cas $c$ constant ; si $c$ est tarabiscoté, il est possible que ce soit possible.}. La valeur de $u$ en $x=L$ est en effet entièrement définie par ce qui vient de la gauche : les caractéristiques transportant de l'information, on ne peut pas spécifier deux conditions sur une même caractéristiques, et comme les caractéristiques transportent l'information vers la droite, la valeur de $u(L, t)$ est déjà spécifiée.

Tient, et si $c<0$, et que l'on considère un domaine borné à gauche ($0\le x < \infty$) ? Que se passe-t-il, que peut-on imposer ? Les caractéristiques sont alors des droites à pente négative, qui transmettent de l'information vers la gauche. Il suffit alors de spécifier une seule condition, par exemple une condition initiale $u(s, 0)=f(s), s\ge 0$, pour que $u$ soit connu $\forall x, t \ge 0$. Cela vient du fait que $s=x-ct\ge 0$ pour n'importe quels $x$ et $t$ du domaine choisi, et la condition initiale peut donc être utilisée partout. Une condition limite en $x=0$ peut également être utilisée partout. Par contre, pour des temps négatifs, il est de nouveau nécessaire de spécifier une deuxième condition. Intuitivement, la condition initiale se déplace vers la gauche, et atteint donc tous les points du plan.

Considérons maintenant le cas où $c=c(x, t)$ ; cette fois, il faut intégrer une relation qui peut être parfois assez complexe. Commençons par un cas où $c=c(x)=\frac{x}{\tau}$ par exemple, et où on considère une condition initiale $u(s, 0)=f(s)$. L'intégration donne
\begin{align*}
\int_{s}^{x} \frac{\dif{x'}}{x'} &= \int_{0}^{t} \frac{\dif{t'}}{\tau} \\
\ln \left( \frac{x}{s} \right) &= \frac{t}{\tau} \\
x &= s e^{t/\tau} \\
s &= x e^{-t/\tau}
\end{align*}
Les caractéristiques sont des courbes exponentielles, et la fonction initiale va donc être déformée. En effet, la solution est
\[ u(x, t)=f(x e^{-t/\tau}) \]

Ce problème était encore relativement simple, la fonction à intégrer étant gentille. Les choses sont rarement aussi idéales. Considérons par exemple $c=c(x)=c_0 \frac{x^2}{x^2+L^2}$, avec $L$ une constante ayant les mêmes dimensions que $x$ (donc, une constante de longueur). Il s'agit d'intégrer
\begin{align*}
c(x) \dif{t} &= 1 \dif{x} \\
\int_{x'=s}^{x'=x} \frac{1}{c} \dif{x'} &= \int_{t'=0}^{t'=t} \dif{t'} \\
\int_{s}^{x} \frac{1}{c_0} \frac{x'^2+L^2}{x'^2} \dif{x'} &= t \\
\left[ x'-\frac{L^2}{x'} \right]_s^x &= c_0 t \\
x-s +L^2 \left(\frac{1}{s} - \frac{1}{x} \right) &= c_0t
\end{align*}
qui est une relation implicite entre $x$, $t$ et $s$. On peut déterminer $s$ en résolvant l'équation du second degré suivante (qui n'est autre qu'une réécriture de la précédente relation) :
\[ s^2 + \left( \frac{L^2}{x} - x + C_0 t \right) - L^2 = 0 \]
Comme on voit, la valeur de $s$ peut être particulièrement compliquée à obtenir. Dans l'APE 2, $c=c(x)=C_0\frac{x^2+(L/2)^2}{x^2+L^2}$ conduit même à résoudre l'équation transcendante
\[ x-s + \frac{3L}{2} \arctan \left( \frac{2L(x-s)}{L^2+4xs} \right) =c_0t\]
pour obtenir $s$.

En toute généralité et pour une condition initiale, si $c=c(x)$, l'intégration donne
\[\int_{s}^{x} \frac{\dif{x'}}{c(x')} = \int_{0}^{t} \dif{t'} = t\]
et, en posant $I(x)=\int_{0}^{x} \frac{\dif{x'}}{c(x')}$\footnote{Comme il s'agit d'une sorte de primitive (la borne inférieure $0$ étant arbitraire), on écrit parfois cette intégrale en omettant la borne inférieur ; c'est alors une primitive, définie à une constante près.},
\[ I(x)-I(s)=t \]
$t$ est alors fonction de $x$ par le biais de la \og primitive \fg{} $I(x)$.

Considérons le cas où $c=c(t)$, et considérons toujours le problème posé en condition initiale. En toute généralité, l'intégration donne cette fois
\[ \int_{s}^{x} \dif{x'} = \int_{0}^{t} c(t') \dif{t'} = x - s\]
et, en posant $H(t)=\int^{t} c(t') \dif{t'}$,
\[ x-s = H(t)-H(0) \]
\[ t=H^{-1} (x-s+H(0)) \]
Pour un temps $t$ fixé, l'écart $x-s$ (entre la position actuelle et la position de départ) est le même quel que soit ce point, et l'écart entre deux points de la courbe initiale est donc constante. Les caractéristiques obtenues sont alors des courbes parallèles (par rapport à l'axe de l'espace) : la fonction $u$ est transportée sans être déformée.
\footnote{C'est assez difficile à se l'imaginer, mais on peut interpréter cela ainsi : la vitesse change au cours du temps, mais elle change \emph{de la même manière} pour tous les points de la courbe. Et donc, la forme de la courbe initiale est conservée, de la même manière qu'un véhicule ne se déforme pas tant que la vitesse de chaque point est identique, même si la voiture accélère.}

Prenons $c(t)=\frac{l}{t+\tau}$, $l$ étant une constante de longueur et $\tau$ une constante de temps. L'intégration donne :
\begin{align*}
\int_{s}^{x} \dif{x'} &= \int_{0}^{t} \frac{l}{t'+\tau} \dif{t'} \\
x-s &= l \left( \ln(t+\tau) - \ln(0+\tau)\right) \\
\frac{x-s}{l} &= \ln\frac{t+\tau}{\tau} \\
s &= x - l \ln\left(1+t/\tau \right)
\end{align*}
ce qui donne finalement comme solution
\[u(x, t)=f\left( x - l \ln(1+t/\tau )\right)\]

Les équations pour lesquelles $c$ est une fonction ont des règles similaires quant aux conditions qui peuvent être posées pour former un problème de Cauchy complet et cohérent. En particulier, si $c=0$ en un point à un instant, la valeur de la fonction reste immobile : rien ne bouge. Si $c>0$, la valeur se déplace vers les $x$ positifs, et si $c<0$, vers les $x$ négatifs. La seule différence vient du fait que $c$ étant une fonction, il est possible que des points qui sont immobiles deviennent soudainement mobiles, et que le comportement de la fonction soit plus difficile à analyser.

On peut également déterminer si un problème est bien posé, en fonction des conditions initiales et limites données. La majorité des problèmes possèdent une condition initiale, la plus simple à déterminer et à utiliser. Pour des vitesses finies, le problème de Cauchy est toujours bien posé. Pour des vitesses non finies, le problème est mal posé si la vitesse devient infinie sur la courbe de Cauchy\footnote{Le problème a aussi de fortes chances de ne pas être résoluble.}.

Dans ce cas, à quelles conditions peut-on donner une condition limite, en particulier une condition à gauche (par exemple, en $x=0$, de sorte que le domaine devient borné à gauche, avec $0 \le x < \infty$) ? Uniquement si cette condition n'est pas redondante. Et pour déterminer cela, on utilise la pente locale de la caractéristique, $\fdif{x}{t}$. Si cette pente est négative, la caractéristique est dite sortante (elle sort du domaine) et l'information concernant la valeur de la fonction vient de l'intérieur du domaine, à droite, et est donc déjà imposée. On ne peut donc pas donner de condition. Si la pente est positive, et la caractéristique entrante, l'information vient de la gauche, et donc de l'extérieur ; il faut donc donner la condition limite, sinon une partie du domaine ne sera pas défini. Si la pente est nulle, on ne peut pas non plus spécifier de caractéristique, et si elle est infinie, on doit le faire.

Ces conditions ne sont valables que dans le cas d'un domaine du type $0 \le x < \infty$ et $0 \le t < \infty$. Dans les autres cas, des critères similaires peuvent être établis, avec le même impératif : la non-redondance. Un croquis du domaine et de ses caractéristiques permet souvent de s'y retrouver.

\section{Équation de transport sous forme conservative}

Une variante de l'équation de transport est l'équation de transport sous forme conservative :
\begin{equation}
\label{eq:order1-transport-consgen}
\fpart{cu}{x} + \fpart{u}{t} = 0
\end{equation}
La vitesse $c$ est à l'intérieur de la dérivée partielle par rapport à $x$. Dans le cas où $c$ n'est pas une fonction de $x$ (par exemple, $c=c(t)$, ou $c$ est constant), on retombe sur l'équation de transport de la section précédente.

Comme d'habitude, on considère un problème posé en condition initiale ($x(s)=s$, $t(s)=0$, et $u(s, 0)=f(s)$). Le domaine peut être soit non borné (ouvert), soit périodique (de période $L$).

L'équation de transport tire son nom du fait qu'elle conserve l'intégrale de la fonction dans le temps. En effet, en notant $\Omega$ le domaine et $\partial \Omega$ son bord, on a
\begin{align*}
\fdif{}{t} \left( \int_\Omega u \dif{x} \right) &= \int_\Omega \fpart{u}{t} \dif{x} \\
&= - \int_\Omega \fpart{}{x}(cu) \dif{x} \\
&= - \left[ cu \right]_{\partial \Omega}
\end{align*}
Il s'agit alors de calculer ce terme. Or, dans le cas d'un domaine périodique, la fonction et la vitesse sont périodiques, ce qui donne
\[-\left[cu\right]_x^{x+L} = -c(x+L)u(x+L) + c(x)u(x) = -c(x)u(x)+c(x)u(x)=0\]
Si le domaine est infini en revanche, on a que $\lim\limits_{x\rightarrow \pm \infty} u = 0$ et $c$ garde une valeur finie. Rappelons que l'on cherche la solution d'un problème d'origine physique : dans le monde réel, peu de quantité tendent vers l'infini, et donc il faut que l'intégrale de $u$ ait aussi une valeur finie, même dans un domaine infini ; cela implique que $u$ s'approche de $0$ à l'infini. Et donc,
\[ -\left[ cu \right]_{-\infty}^{+\infty} = -0+0=0\]
Par conséquent, l'intégrale ne varie pas dans le temps, et la fonction est conservée. Cette affirmation n'est plus vraie si $u$ est discontinue ou possède des singularités ; dans ce cas, l'intégrale a tendance à varier.
\footnote{Il peut arriver que l'on étudie un problème qui n'a pas d'origine physique.} Les phénomènes où la quantité globale est conservée sont assez fréquent en pratique.

Autant l'intégrale de $u$ est conservée dans le temps, autant $u$ lui même n'est plus conservé le long des caractéristiques. En effet, en développant l'équation,
\[c \fpart{u}{x} + \fpart{u}{t} = -u \fpart{c}{x}\]
on constate que $R\neq 0$. Le long des caractéristiques, la variation de $u$ est donnée par
\[ \dif{u} = -u \fpart{c}{x} \dif{t} \]

Considérons le cas où $c=c(x)$ (c'est le cas le plus fréquent). Dans ce cas, on peut écrire, via la relation des caractéristiques, que $\dif{t} = \frac{1}{c} \dif{x}$ (les dérivées partielles deviennent des dérivées simples) et donc, la relation de compatibilité devient
\[ \dif{u} = -u \fdif{c}{x} \frac{1}{c} \dif{x} \]
\[\Leftrightarrow c \dif{u} + u \dif{c} = \dif{(cu)} = 0\]
Par conséquent, $cu$ est conservé le long de chaque caractéristique ! Le développement complet nous aurait amené à la même conclusion, et on a donc
\[u(x, t) = \frac{c(s)}{c(x)} u(s, 0)=\frac{c(s)}{c(x)} f(s)\]
avec $s$ qui peut être obtenu à partir de la relation caractéristique. Les équations de transport conservatives sont donc à peine plus compliquées que les équations non-conservatives.

%Est-ce qu'une autre quantité est conservée ? Peut-être l'énergie $u^2/2$ :
%\footnote{Ici, $a=-\infty$ et $b=+\infty$ pour un domaine ouvert, et $a=x$ et $b=x+L$ pour un domaine périodique.}
%\begin{align*}
%\fdif{}{t} \int_{a}^{b} \frac{u^2}{2} \dif{x} &= \int_{a}^{b} \fdif{}{t} \left( \frac{u(x, t)^2}{2} \right) \dif{x} \\
%&=
%\end{align*}

Un cas intéressant est celui du puits de vitesse. La vitesse s'exprime alors
\begin{align*}
c(x) &= c_\mathrm{max} - \frac{c_\mathrm{max}-c_\mathrm{min}}{1+x^2/a^2} \\
&= \frac{c_\mathrm{min}+c_\mathrm{max}x^2/a^2}{1+x^2/a^2} \\
&= \frac{a^2 c_\mathrm{min} + x^2 c_\mathrm{max}}{x^2+a^2}
\end{align*}
La vitesse présente un minimum en $x=0$. La fonction $u$ est alors déformée lors du passage au niveau du puits de vitesse ; en entrant dans le puits, la vitesse diminue, ce qui implique que la valeur de la fonction augmente dans le puits, l'intégrale devant être conservée. En sortant du puits, la vitesse augmente et la fonction diminue à nouveau. On a donc une sorte de \og sursaut \fg{} de la fonction à l'intérieur de la vitesse.

%TODO équations non linéaires, équation de Burgers, discontinuités.

%TODO EDP du second ordre, méthode des caractéristiques.

%TODO Systèmes d'EDP du premier ordre

\section{Méthode de séparation des variables}

\end{document}
