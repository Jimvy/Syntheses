\documentclass[fr, usereportclass]{../../../eplnotes}

\usepackage[SIunits]{../../../eplunits}

\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage[frenchb]{babel}

\makeatletter % from http://tex.stackexchange.com/questions/75831/how-do-i-show-the-equation-formula-again-instead-of-its-number-of-ref
% alternative : http://latex-community.org/forum/viewtopic.php?f=46&t=8275
\newcommand{\repeatable}[2]{
	\label{#1}\global\@namedef{repeatable@#1}{#2}#2
}
\newcommand{\recalleq}[2]{
	\@isundefined{repeatable@#1}{NOT FOUND}{$\@nameuse{repeatable@#1}$}
	~\eqref{#1}
}
\makeatother

\hypertitle{math-FSAB1103}{3}{FSAB}{1103}
{Jean-Martin Vlaeminck} % narcissique ? Pas vraiment
{Jean-François Remacle, Grégoire Winckelmans et Roland Keunings}[
\paragraph{Remarque importante}
Ce document a été conçu sur base du syllabus sur les équations aux dérivées partielles, et sur les cours magistraux donnés lors de l'année académique 2016-2017. Il a pour objectif de couvrir l'ensemble de la matière utile pour les cours et pour les examens, et d'être plus facile à lire que le syllabus officiel.
]

\newcommand{\fnpart}[3]{\frac{\partial^{#3} #1}{\partial #2^{#3}}}
\theoremstyle{definition}
\newtheorem{defn}{Définition}[section] % mydef
\newtheorem{thm}{Théorème}[section] % mytheo
\newtheorem{lemme}[thm]{Lemme} % mylem
\newtheorem{propriete}[thm]{Propriété} % myprop
\newtheorem{exemple}{Exemple} % myexem

% commandes :
% \fpart{u}{x} donne du/dx avec des partial
% \ffpart{u}{x} donne d^2 u/dx^2 (partial)
% \fdpart{u}{x}{y} donne d^2 u/dx dy (partial)
% \fdif{u}{x} donne du/dx avec des d droits
% \ffdif{u}{x} donne d^2 u/dx^2 (d droits)
% \dif{t} donne dt
% \divn{V} donne la divergence de V
% \rotn{V} donne le rotationnel de V
% \grad{V} donne le gradient
% \lap{V} donne le laplacien

\part{Équations aux dérivées partielles}

\chapter*{Introduction et définitions}
\addcontentsline{toc}{chapter}{Introduction et définition}

Soit une fonction scalaire $u$, qui est notre inconnue, dépendant de $m$ variables $x_1, x_2, \ldots, x_m$ (par exemple les trois coordonnées de l'espace). Une relation $\mathcal{F}$ entre $u$, les variables $x_i$ et les dérivées partielles de $u$ par rapport à ces variables,
\[ \mathcal{F} \left( u, x_1, \ldots, \fpart{u}{x_1}, \ldots, \ffpart{u}{x_1}, \ldots, \fdpart{u}{x_1}{x_2}, \ldots, \fnpart{u}{x_1}{n} \right) = 0\]
définit une \emph{équations aux dérivées partielles} d'ordre $n$ (EDP).

La résolution d'une telle équation dépend de plusieurs facteurs et de plusieurs caractéristiques de l'équation, dont l'ordre de l'équation ($n$), sa (non-)linéarité, son homogénéité et encore d'autre facteurs.

\emph{L'ordre} d'une EDP est l'ordre de la dérivée partielle dont l'ordre est la plus élevée. Par exemple, $\fpart{u}{x} + \fdpart{u}{y}{x} -u^3=0$ est d'ordre $2$.

L'équation suivante, avec $A, B, C, D$ et $F$ des fonctions de $x$, $y$ et $u$
\begin{equation}
\label{eq:intro-exemple1}
 A \ffpart{u}{x} + B \fdpart{u}{x}{y} + C \ffpart{u}{y} + Du = F
\end{equation}
est une équation d'ordre 2, et à deux variables ; $m=2$ et $n=2$. Les fonctions $A, B, C, D, F$ sont les coefficients des dérivées partielles. S'il s'agit de fonctions constantes, on parle d'\emph{EDP à coefficients constants}.

Une EDP est dite \emph{linéaire} quand elle l'est par rapport à $u$ et à toutes ses dérivées partielles : la relation $\mathcal{F}$ est linéaire par rapport à $u$ et à ses dérivées, mais pas par rapport aux $x_i$. Par exemple, si les fonctions $A, B, C, D, F$ de l'équation précédente \ref{eq:intro-exemple1} sont des fonctions de $x$ et $y$, mais pas de $u$ ou d'une de ses dérivées partielles, alors l'équation est linéaire. Une propriété importante des équations linéaires \emph{homogènes} est le \emph{principe de superposition} : si $u(x, y)$ et $v(x, y)$ sont solutions de l'équation, alors toute combinaison linéaire de $u$ et $v$ est aussi solution. C'est d'ailleurs une manière de vérifier la (quasi)-linéarité : on vérifie le principe de superposition pour cette EDP (en enlevant toutefois les termes non homogènes).

Une EDP est dite \emph{quasi-linéaire} quand elle est linéaire par rapport aux dérivées partielles d'ordre le plus élevé en chacune des variables, c'est-à-dire que les coefficients devant les dérivées partielles d'ordre les plus élevés ne dépendent pas de $u$. Les équations quasi-linéaire se résolvent avec des techniques fort similaires aux techniques utilisées pour les équations linéaires. Elles sont très fréquentes en physique, bien plus que les équations linéaires, et obéissent aux mêmes schémas de \emph{stabilité} numériques que les équations linéaires. Parfois, elles peuvent être écrites sous une forme que l'on qualifie de \emph{forme conservative}.

Une EDP est dite \emph{homogène} quand elle ne contient que des termes ne faisant intervenir $u$ ou ses dérivées partielles. Par exemple, l'équation \ref{eq:intro-exemple1} est homogène si $F=0$. Une équation homogène admet toujours la solution nulle $u=0$. Une EDP linéaire mais non-homogène a comme solution générale la somme d'une solution particulière de l'équation non-homogène et de la solution générale de l'équation homogène correspondante, tout comme leurs cousins EDO.

Enfin, la solution d'une équation aux dérivées partielles, $u=f(x_1, \ldots, x_m)$, est qualifiée de \emph{surface intégrale} ou simplement une intégrale de l'EDP.

Terminons cette introduction par une remarque importante : toutes les équations que l'on va voir dans ce cours ont une interprétation physique. Cela a des conséquences sur les unités présentes dans les équations (comme on verra dans la section suivante) et cela implique également que les solutions que l'on recherche ont une valeur finie en n'importe quel point (pas de singularité, comme une valeur infinie au milieu du domaine) et qu'elles diminuent et approchent de zéro lorsqu'on s'éloigne de la région d'intérêt : la solution tend vers $0$ quand la position $(x, y, z)$ tend vers l'infini, ou $\lim\limits_{(x, y, z)\rightarrow\infty} u = 0$.

\section*{Quelques exemples, et une remarque concernant les unités}
\addcontentsline{toc}{section}{Quelques exemples, et une remarque concernant les unités}

Afin de mieux comprendre les différents types d'EDP, le mieux est de s'attarder sur quelques exemples, parfois notables.

\[ \ffpart{u}{x} + \ffpart{u}{y} = 0\]
est une EDP à deux variables, d'ordre $2$, linéaire (l'opérateur de dérivation est linéaire), à coefficients constants, et homogène (le membre de droite est nul, et la solution $u=0$ satisfait l'équation). Il s'agit de l'\emph{équation de Laplace}.

\[ x \fpart{u}{x} + y \fpart{u}{y} + \frac{xy}{l^2} u=2u_0 \]
est une équation d'ordre $1$, linéaire (vérifiez !), à coefficients non constants (ce sont des fonctions) et non homogène (le membre de droite est supposé non nul). La présence de la constante $l$ n'est pas anodin : dans le cadre de ce cours, toutes les équations que l'on voit ont une interprétation physique, et ont donc des dimensions et des unités. Ici, $x$ et $y$ ont des unités d'une longueur, et donc $l$ doit avoir les unités d'une longueur également. De même, $u_0$ doit avoir les mêmes dimensions que $u$ (température, pression, chaleur, \ldots).

\[ \left(\fpart{u}{y}\right)^2 \ffpart{u}{x} + \left(\fpart{u}{x}\right)^2 \ffpart{u}{y} = 0 \]
est une équation d'ordre $2$, homogène, non linéaire (à cause des carrés), mais bien quasi-linéaire. En effet, les dérivées partielles d'ordre 2 sont des fonctions linéaires (elles ne sont pas élevées au carré, prises dans un logarithme ou dans un sinus, \ldots) ; le fait que le coefficient de ces dérivées d'ordre 2 dépendent de $u$, voire même de $\fpart{u}{x}$ au carré, ne change pas le fait qu'elle est linéaire.

\[ \fpart{u}{y} \ffpart{u}{x} + \frac{1}{l} \left(\fpart{u}{x}\right)^2 +\fpart{u}{x} \ffpart{u}{y} = 0\]
est également d'ordre $2$, homogène et quasi linéaire (seuls les dérivées d'ordre 2 comptent).

\[ \frac{1}{l} \left(\fpart{u}{x}\right)^2 + \fpart{u}{x} \ffpart{u}{y} = 0 \]
est d'ordre $2$, homogène, mais pas quasi linéaire. En effet, elle est linéaire par rapport à la dérivée partielle la plus élevée en $y$ (qui est $\ffpart{u}{y}$), mais pas par rapport à celle en $x$, qui est $\fpart{u}{x}$.

\[ c \fpart{u}{x} + \fpart{u}{t} = 0 \]
est une EDP à deux variables (une spatiale, $x$, et une temporelle, $t$), d'ordre $1$, linéaire, à coefficients constants si $c$ est une constante, et homogène. L'EDP reste linéaire si $c$ est une fonction de $x$ et/ou de $t$, mais n'est plus linéaire (mais quasi-linéaire) si $c$ est une fonction de $u$. C'est l'\emph{équation de transport}.

\[ u \fpart{u}{x} + \fpart{u}{t} = 0 \]
est une EDP d'ordre $1$, quasi linéaire et homogène. C'est l'\emph{équation de Burgers}, qui peut aussi s'écrire sous une forme dite conservative,
\[ \fpart{}{x} \left( \frac{u^2}{2} \right) + \fpart{u}{t} = 0 \]

\[ \fpart{}{x} \left( \alpha(u) \fpart{u}{x} \right) - \fpart{u}{t} = 0 \]
est, enfin, une EDP d'ordre 2, quasi-linéaire (ceci peut être vérifié en développant l'équation par la règle du produit) et homogène. Si $\alpha(u) > 0$, il s'agit de l'équation de diffusion, avec $\alpha$ le coefficient de diffusivité. %TODO mettre le développement dans la section de l'équation de diffusion.

\chapter{EDP d'ordre 1}

Commençons donc par étudier et résoudre les EDP du 1er ordre. Ces EDP sont dites \emph{à caractère hyperbolique} (on verra plus loin ce que cela signifie). Les équations que nous allons voir dépendent de deux paramètres, $x$ et $y$ (équation dans un plan 2D, indépendante du temps) ou $x$ et $t$ (équation en 1D dépendante du temps), et on a donc, en reprenant les notations de l'introduction, $n=1$ et $m=2$. Dans la suite, on utilisera $x$ et $y$.

Les EDP du 1er ordre quasi linéaires ont la forme
\begin{equation}
\label{eq:order1-genequa}
P \fpart{u}{x} + Q \fpart{u}{y} = R
\end{equation}
avec $P, Q, R$ des fonctions qui dépendent, au plus, de $x$, $y$ et $u$ (elles ne peuvent pas dépendre des dérivées partielles, sinon l'équation ne serait plus linéaire). $R$ peut toujours être écrit sous la forme $R(x, y, u) = F(x, y) + H(x, y, u)$. L'équation sera homogène si $F=0$ (tous les termes dépendent de $u$)\footnote{Et très probablement, si $H$ est une fonction linéaire en $u$.}.
% FIXME le très probablement signifie simplement que je ne suis pas sûr.

Les EDP du 1er ordre linéaires ont presque la même forme, à savoir
\begin{equation}
\label{eq:order1-genequalin}
P \fpart{u}{x} + Q \fpart{u}{y} + Gu = F
\end{equation}
où $P, Q, F$ et $G$ sont des fonctions de $x$ et/ou de $y$, mais pas de $u$. Et l'équation est homogène si $F=0$ (dans ce cas, $u=0$ est bien solution). La principale différence entre les EDP quasi-linéaires et linéaires vient du fait que la fonction $R$ s'écrit $R(x, y, u) = F(x, y) - G(x, y)\cdot u$, avec $H(x, y, u) = G(x, y) \cdot u$ ; la fonction $H$ est bien linéaire en $u$.

La solution de cette EDP, notée $u(x, y)$, est alors une surface dans l'espace de dimension 3. Cette surface peut être décrite à partir d'une relation explicite ($u(x, y)$) ou à partir d'une relation implicite ($\mathcal{F}(x, y, u)=0$). Dans la suite, nous considérerons surtout les équations non nécessairement homogènes.

\section{Méthode des caractéristiques}

Une EDP seule n'est pas résoluble. De la même manière qu'il faut, dans le cas des équations différentielles ordinaires, donner un certain nombre de conditions afin d'obtenir une solution unique, il va falloir donner une sorte de condition initiale afin de pouvoir résoudre le problème. Cette condition initiale sera, dans le cas des EDP à deux variables, une courbe paramétrée $\Gamma(s) \equiv (x(s), y(s))$ sur laquelle on donne la valeur de $u$ : $u(x(s), y(s)) = f(s)$. Le problème de déterminer $u$ sur l'ensemble du domaine, à partir de l'EDP et de la valeur de $u$ sur la courbe $\Gamma$ (nommé \emph{arc ou courbe de Cauchy}), constitue le \emph{problème de Cauchy} (figure \ref{fig:order1-Cauchy}).

\begin{figure}
	\centering
	\begin{tikzpicture}[scale=5]
	% Axes
	\draw[>=stealth, ->] (-0.2, 0) -- (2, 0);
	\draw (2, 0) node[right] {$x$};
	\draw[>=stealth, ->] (0, -0.2) -- (0, 1);
	\draw (0, 1) node[above] {$y$};
	% courbe de Cauchy
	\draw[thick] [domain=-0.2:1.5] plot [variable=\x, samples=100] (\x, {0.4*\x^4-0.4*\x^3-0.4*\x+0.6});
	\draw (0.5, 0.5) node[above] {$\Gamma\equiv (x(s), y(s))$};
	\draw (0.6, 0.4) node[right] {$u(x(s), y(s))=f(s)$};
	\draw[>=stealth, ->] (1.35, 0.5) -- (1.45, 0.7) node[midway, above left] {$s$};
	\end{tikzpicture}
	\caption{Représentation du problème de Cauchy. La valeur de $u$ est connue le long de la courbe $\Gamma$ paramétrée par $s$.}
	\label{fig:order1-Cauchy}
\end{figure}

Pour résoudre les EDP du 1er ordre, une méthode particulièrement utile et puissance est la \emph{méthode des caractéristiques}. Le principe de cette méthode est la suivante : comme nous connaissons la valeur de $u$ sur $\Gamma$, ainsi que la variation de $u$ dans un voisinage de $\Gamma$ (grâce à l'EDP), il doit être possible de déterminer $u$ dans un voisinage de $\Gamma$, et d'appliquer à nouveau ce principe pour déterminer $u$ en n'importe quel point. On détermine donc $u(x, y)$ de proche en proche, en partant de la courbe $\Gamma$ et en utilisant l'équation différentielle pour obtenir les solutions intermédiaires entre $\Gamma$ et $(x, y)$, ce qui nous permet alors de bien calculer $u$.

Tout le problème devient à présent de déterminer s'il est possible, et à quelles conditions, de déterminer $u$ dans un voisinage d'une courbe, étant donné l'EDP. De même, nous aimerions une méthode générique, dépendant le moins possible de la courbe $\Gamma$ donnée, et de la valeur de $u$ sur cette courbe (la fonction $f(s)$, généralement donnée). Idéalement, les données liées à $\Gamma$ ne devraient avoir un impact qu'à la fin de la résolution. Voyons donc ce que l'on peut faire.

Tout d'abord, comme $u(x(s), y(s))=f(s)$ est connu sur la courbe de Cauchy, la dérivée partielle de $u$ par rapport au paramètre $s$ est également connu (c'est $f'(s)$), et donc
\footnote{Pour ceux qui se le demanderaient, l'utilisation de la notation avec $\partial$ dans les dérivées partielles est généralement utilisée quand la fonction dépend de plusieurs variables. Si la fonction est à une seule variable, on utilise généralement $\mathrm{d}$ à la place de $\partial$.}
\begin{equation}
\label{eq:order1-duds}
f'(s) = \fdif{u}{s} = \fpart{u}{x} \cdot \fdif{x}{s} + \fpart{u}{y} \cdot \fdif{y}{s}
\end{equation}
C'est une équation supplémentaire qui relie $\fpart{u}{x}$ et $\fpart{u}{y}$ ; on peut donc écrire, à partir de cette équation et notre EDP (équation \ref{eq:order1-genequa}), le système
\begin{equation}
\label{eq:order1-bienpose-edp-duds}
\begin{pmatrix}
P & Q \\
\fdif{x}{s} & \fdif{y}{s} \\
\end{pmatrix}
\begin{pmatrix}
\fpart{u}{x} \\
\fpart{u}{y} \\
\end{pmatrix}
= \begin{pmatrix}
R \\
\fdif{u}{s} = f'(s) \\
\end{pmatrix}
\end{equation}

Dans ce système, les fonctions $P$, $Q$, $R$, les dérivées $\fdif{x}{s}$, $\fdif{y}{s}$ et $f'(s)=\fdif{u}{s}$ sont toutes connues. Si le déterminant est non nul, on peut alors toujours déterminer les dérivées partielles $\fpart{u}{x}$ et $\fpart{u}{y}$, et donc déterminer la valeur de $u$ un peu à côté de notre point de référence sur $\Gamma$ ; en effet, du cours de maths 2, on sait que
\begin{equation}
\label{eq:order1-propag}
u(x+\dif{x}, y+\dif{y}) = u(x, y) + \fpart{u}{x}(x, y) \dif{x} + \fpart{u}{y}(x, y) \dif{y}
\end{equation}

On peut donc déterminer $u$ un peu plus loin de $\Gamma$, et réitérer le processus afin de déterminer $u$ au point qui nous intéresse. Sauf que ce système, et donc cette relation, n'est valable que sur $\Gamma$, ou sur une courbe paramétrée sur laquelle on connait $u$, ce qui n'est pas pratique. Il faut donc trouver une meilleure manière de déterminer cette \og propagation \fg{} de la solution.

Cette méthode ne fonctionne que si le déterminant ne s'annule pas. Si le déterminant s'annule, il est impossible de déterminer les dérivées partielles, et toute la résolution s'écroule. On dira que \emph{le problème de Cauchy est \strong{bien posé}} ssi le déterminant du système ne s'annule en aucun des points de la courbe. Il est donc important, lorsqu'on pose un problème de Cauchy, de spécifier $\Gamma$ de telle sorte que le problème résultant soit bien posé.

Voyons maintenant ce qu'il se passe si on tente de propager l'équation selon une direction $(\dif{x}, \dif{y})$. Cette direction doit, bien évidemment, être non parallèle à la courbe (sinon on n'avance pas). Autrement dit,
\[ (\dif{x}, \dif{y}) \neq \alpha \left(\fdif{x}{s}, \fdif{y}{s}\right) \quad \alpha \in \mathrm{R} \]
La variation de $u$, le long de cette direction, peut être exprimée par la différentielle
\begin{equation}
\label{eq:order1-diffdu}
\fpart{u}{x} \dif{x} + \fpart{u}{y} \dif{y} = \dif{u}
\end{equation}
On peut dès lors former un nouveau système avec notre EDP,
\begin{equation}
\label{eq:order1-dirpart}
\begin{pmatrix}
P & Q \\ \dif{x} & \dif{y} \\
\end{pmatrix}
\begin{pmatrix}
\fpart{u}{x} \\ \fpart{u}{y} \\
\end{pmatrix}
= \begin{pmatrix}
R \\ \dif{u} \\
\end{pmatrix}
\end{equation}
Afin de simplifier les calculs, nous allons choisir $\dif{x}$ et $\dif{y}$ tels que le déterminant de cette équation s'annule. Cela correspond à une direction particulière, où le calcul de la propagation de $u$ est plus simple. Plus précisément, il s'agit d'une direction telle que
\begin{equation}
\label{eq:order1-caractode}
P\dif{y} = Q \dif{x}
\end{equation}
soit $\frac{P}{Q} = \frac{\dif{x}}{\dif{y}}$, ou encore $(\dif{x}, \dif{y}) \propto (P, Q)$ ; la direction $(\dif{x}, \dif{y})$ est, en quelque sorte, parallèle à la direction définie par $P$ et $Q$.

Le système \ref{eq:order1-dirpart} ne doit pas être confondu avec le système \ref{eq:order1-bienpose-edp-duds}. Ce dernier exprime une condition sur $\Gamma$, telle que le problème est bien posée ; tandis que le système \ref{eq:order1-dirpart} permet de déterminer une direction locale intéressante, parallèle à $(P, Q)$. Cette direction n'est jamais parallèle à la direction de la courbe de Cauchy ; si tel était le cas, le déterminant de \ref{eq:order1-bienpose-edp-duds} serait nul, et le problème serait mal posé
\footnote{Si $(\dif{x}, \dif{y}) = k \cdot \left(\fdif{x}{s}, \fdif{y}{s}\right)$, autrement dit s'ils sont parallèles, alors le déterminant de \ref{eq:order1-bienpose-edp-duds} devient \[ \begin{vmatrix} P & Q \\ \fdif{x}{s} & \fdif{y}{s} \\ \end{vmatrix} = \frac{1}{k} \begin{vmatrix} P & Q \\ \dif{x} & \dif{y} \\ \end{vmatrix} =0 \] et donc, le problème serait déjà mal posé à la base.}.

Si le problème est bien posé, alors cette direction particulière n'est jamais parallèle à la courbe $\Gamma$, et définit, en tout point du plan, ce que l'on appelle la \emph{direction caractéristique}. Et en suivant, à partir d'un point donné de $\Gamma$, les différentes directions caractéristiques, on obtient la \emph{courbe caractéristique} : une courbe qui suit, qui est tangente à la direction caractéristique en tout point. On obtient donc, à partir de l'équation $P\dif{y} = Q\dif{x}$, un \emph{réseau de courbes caractéristiques} (figure \ref{fig:order1-reseau-caract})

\begin{figure} % TODO improve
	\centering
	\begin{tikzpicture}[scale=5]
	% Axes
	\draw[>=stealth, ->] (-0.2, 0) -- (2, 0);
	\draw (2, 0) node[right] {$x$};
	\draw[>=stealth, ->] (0, -0.2) -- (0, 1);
	\draw (0, 1) node[above] {$y$};
	% courbe de Cauchy
	\draw[thick] [domain=-0.2:1.5] plot [variable=\x, samples=100] (\x, {0.4*\x^4-0.4*\x^3-0.4*\x+0.6});
	\draw (0.5, 0.5) node[below right] {$\Gamma$};
	% caractéristique
	\draw[thick] [domain=1.1:1.4] plot [variable=\x] (\x, {4*\x^2-12*\x+9});
	\draw (1.3, 0.2) node[right] {$C_s$};
	\draw (1.235, 0.28) node {$\bullet$};
	\end{tikzpicture}
	\caption{La courbe de Cauchy et une des caractéristiques $C_s$. Il y a en fait une multitude de caractéristiques différentes.}
	\label{fig:order1-reseau-caract}
\end{figure}

Chaque courbe caractéristique doit croiser une seule fois la courbe de Cauchy $\Gamma$, pour que le problème soit bien posé ; en effet, la courbe caractéristique issue d'un point $P$ sur $\Gamma$ va nous permettre de calculer $u$ sur l'ensemble des points de cette caractéristique. Il est donc important que la courbe caractéristique ne croise qu'une seule fois la courbe de Cauchy ; sinon, on imposerait plusieurs conditions sur cette courbe, ce qui donne généralement des incompatibilités. Également, si l'on peut imposer n'importe quelle valeur pour $u$ sur $\Gamma$, on ne peut pas imposer $u$ sur une caractéristique : la valeur de $u$ est dictée par l'EDP, qui dicte les caractéristiques et par la courbe de Cauchy.
%TODO montrer (si c'est possible) que nécessairement, si le problème est bien posé au sens matriciel, alors le problème est bien posé au sens du croisement des caractéristiques

Comment obtenir l'équation d'une des courbes caractéristiques ? En intégrant la direction caractéristique, depuis un point de $\Gamma$ $(x(s), y(s))$ jusqu'à un point $(x, y)$. Plus précisément\footnote{Dans cette équation, $P'$ et $Q'$ sont deux fonctions, dépendant uniquement respectivement de $y$ et de $x$ ; elles peuvent obtenues à partir de $P(x, y)$ et $Q(x, y)$ en isolant $x$ et $y$ de chaque côté. Les variables $x'$ et $y'$ sont les mêmes que $x$ et $y$, mais ces symboles sont déjà utilisées dans les bornes de l'intégrale (les fameuses \emph{dummy variables}).} :
\begin{equation}
\label{eq:order1-caractcurve_integral}
\begin{split}
P \dif{y} &= Q \dif{x} \\
\int_{x(s)}^{x} P'(y') \dif{y'} &= \int_{y(s)}^{y} Q'(x') \dif{x'}
\end{split}
\end{equation}
L'idée est que, pour déterminer les points $x$ et $y$ qui seront atteignables par la caractéristique issue d'un point de la courbe de Cauchy en $(x(s), y(s))$ pour un $s$ donné, on va suivre et intégrer la direction caractéristique, et donc parcourir la courbe, depuis ce point de la courbe de Cauchy jusqu'à un point $(x, y)$ que l'on suppose appartenir à la caractéristique. Cela donne donc une relation entre $x$ et $y$ pour un $s$ donné, et également une relation qui donne $s$ en fonction de $x$ et $y$. $s$ est une constante dans cette relation, et paramétrise la courbe : pour un $s$ donné, on obtient une courbe caractéristique précise.

Maintenant que l'on connait une direction caractéristique, comment peut-on propager notre solution $u$ le long de cette caractéristique ? Tout simplement en utilisant le système \ref{eq:order1-dirpart}. Comme le déterminant principal s'annule, la seule manière d'avoir encore une solution est que le déterminant formé en remplaçant une colonne de la matrice principale, par la colonne des termes indépendants, s'annule également (un peu à la Kramer). C'est-à-dire :
\[ \begin{vmatrix} P & R \\ \dif{x} & \dif{u} \\ \end{vmatrix} = 0 \quad \quad \begin{vmatrix} R & Q \\ \dif{u} & \dif{y} \\ \end{vmatrix} = 0 \]
\begin{equation}
\label{eq:order1-compatode}
\Leftrightarrow P\dif{u} = R\dif{x} \quad \quad Q\dif{u} = R\dif{y}
\end{equation}

Les deux relations obtenues sont des \emph{relations de compatibilité}, ou relations caractéristiques ; elles définissent le comportement de $u$ qui est compatible avec la direction, et donc la courbe, caractéristique. Elles permettent de relier $\dif{u}$ à la variation $\dif{x}$ le long de la caractéristique. Or, ces relations sont des équations différentielles ordinaires ; notre EDP est donc devenue une EDO le long de chaque caractéristique, ce qui est beaucoup plus simple à résoudre.

Désormais, pour déterminer $u$ à un point $A$ donné, il ne reste plus qu'à intégrer la relation de compatibilité le long de la caractéristique, depuis un point $B$ sur la courbe de Cauchy (où l'on connait $u$) jusqu'à notre point $A$ (où l'on veut connaitre $u$)
\footnote{Le point $B$ peut être déterminé, vu que s'il y a une caractéristique qui passe par $A$, alors cette caractéristique croise une seule fois la courbe de Cauchy. Il est néanmoins possible que l'on ne puisse pas calculer $u$ à un certain point, si la courbe de Cauchy ou si les caractéristiques empêchent la propagation de $u$ en ce point : caractéristiques absentes, $\Gamma$ trop courte.}.

Notons qu'une seule des deux relations de compatibilité est requise pour l'intégration ; l'autre relation peut directement être obtenue à partir de l'une et de \ref{eq:order1-caractode}. Une manière de retenir ces relations est
\begin{equation}
\label{eq:order1-diffeqnmemo}
\frac{\dif{x}}{P} = \frac{\dif{y}}{Q} = \frac{\dif{u}}{R}
\end{equation}
(relation connue comme les équations de Lagrange-Charpit).
Néanmoins, comme $P$, $Q$ ou $R$ peuvent s'annuler, il vaut mieux revenir à la forme normale de ces équations lors de l'intégration. C'est essentiellement un moyen mnémotechnique. De même, il vaut mieux choisir la relation la plus simple à intégrer.

Une relation supplémentaire qui peut être utile est $\sqrt{P^2+Q^2} \dif{u} = R\dif{l}$ ; celle-ci relie la variation de $u$ avec la variation $\dif{l}$ directement le long de la caractéristique (dans l'axe de la caractéristique), de sorte que $\dif{l}^2 = \dif{x}^2 + \dif{y}^2$. La démonstration est simplement une règle de la chaine sur $\fdif{u}{l}$, avec quelques manipulations à partir des relation \ref{eq:order1-diffeqnmemo}.

Le cas où $R=0$ donne $\dif{u}=0$ le long de la caractéristique : $u$ est alors constant le long de la caractéristique. On appelle ça un \emph{invariant de Riemann}.

Les EDP du 1\ier{} ordre (avec des fonctions réelles) ont toutes la propriété d'être \emph{à caractère hyperbolique}. Cette propriété peut être résumée, de manière informelle, par le fait qu'elles ont toutes la particularité de pouvoir être résolues par une sorte de propagation de la solution le long de caractéristiques.
\footnote{Le concept sera éclairci lorsqu'on abordera les EDP du second ordre.}

Une dernière remarque avant de passer à des exemples. Une certaine EDP du premier ordre, de la forme de l'équation \ref{eq:order1-genequa}, définit un réseau de caractéristiques, via la relation $P\dif{y}=Q\dif{x}$. L'inverse est aussi vrai : un réseau de caractéristiques définit une unique relation de la forme $P\dif{y}=Q\dif{x}$, et donc une EDP du 1\ier{} ordre. Il y a une bijection entre les EDP du 1\ier{} ordre et les réseaux de caractéristiques, et il faut donc être préparé à travailler dans les deux sens (l'examen de septembre 2016 en est un parfait exemple...).

\section{Exemples}

Afin d'illustrer la méthode des caractéristiques, considérons l'EDP suivante
\[y\fpart{u}{x} - x\fpart{u}{y} = R\]
et la courbe $\Gamma$ définie par $x(s)=s$ et $y(s)=0$, pour $s$ strictement positif (on verra pourquoi). Il s'agit du demi-axe des x strictement positifs. On spécifie sur cette courbe une fonction $f(s)$ donnée (ici, peu importe sa définition).

On commence par déterminer le réseau des caractéristiques. Puisque $P=y$ et $Q=-x$, les caractéristiques sont déterminées par l'intégration suivante (équation \ref{eq:order1-caractcurve_integral}) :
\begin{align*}
P \dif{y} &= Q \dif{x} \\
y \dif{y} &= -x \dif{x} \\
\int_{y(s)}^{y} y' \dif{y'} &= \int_{x(s)}^{x} -x' \dif{x'} \\
\int_{0}^{y} y' \dif{y'} &= \int_{s}^{x} -x' \dif{x'} \\
\frac{y^2}{2} &= \frac{s^2}{2} - \frac{x^2}{2} \\
x^2 + y^2 &= s^2
\end{align*}

Comment interpréter cette intégration ? Nous avons suivi la direction caractéristique depuis un point de $\Gamma$ jusqu'à un point $(x, y)$. Cela donne donc une relation entre $x$ et $y$ pour $s$ donné, et également une relation qui donne $s$ en fonction de $x$ et $y$.

Ici, pour un $s$ donné, la caractéristique n'est rien d'autre que le cercle de rayon $s$ centré à l'origine ; le réseau est donc un ensemble de cercles concentriques. C'est pour ça qu'on a défini la courbe de Cauchy ainsi : la demi-droite ne coupe chaque cercle qu'une seule fois, et n'est pas parallèle à la tangente au cercle. $\Gamma$ est donc admissible et le problème est bien posé.

Ensuite, il ne reste plus qu'à calculer $u$ en chaque point. Pour cela, on utilise une des relations de compatibilité, $P\dif{u} = R\dif{x}$ ou $Q\dif{u}=R\dif{y}$, et on intègre :
\[\int_{u(x(s), y(s))}^{u(x, y)} P \dif{u'} = \int_{x(s)}^{x} R\dif{x'}\]
ou
\[\int_{u(x(s), y(s))}^{u(x, y)} Q \dif{u'} = \int_{y(s)}^{y} R\dif{y'}\]

Considérons le cas où $R=0$. L'équation est alors homogène, et les relations de compatibilité deviennent $\dif{u}=0$ ($P$ et $Q$ ne sont pas nuls en général). Cela signifie que $u$ a la même valeur sur toute la caractéristique. De fait, si on effectue l'intégrale,
\begin{align*}
\int_{u(x(s), y(s))}^{u(x, y)} P \dif{u'} &= \int_{x(s)}^{x} R\dif{x'} \\
\int_{u(x(s), y(s))}^{u(x, y)} y \dif{u'} &= \int_{x(s)}^{x} 0 \dif{x'} \\
&= 0 \\
\Rightarrow u(x, y) &= u(x(s), y(s))
\end{align*}
Et comme, pour $x$ et $y$ donnés, on a $x^2+y^2=s^2$, on a $s=\sqrt{x^2+y^2}$ et donc,
\[u(x, y) = f\left(\sqrt{x^2+y^2}\right)\]

Considérons un cas plus complexe, celui où $R=\frac{u_0xy}{l^2}$. On remarque tout de suite la présence du $l^2$ au dénominateur ; celui-ci sert à rendre adimensionnel le produit $xy$, de sorte que $R$ ait les mêmes dimensions que $u_0$ et donc $u$. Les dimensions sont très importantes dans ce cours.

En intégrant l'une des deux relations de compatibilité (par exemple la première), on obtient
\begin{align*}
\int_{u(x(s), y(s))}^{u(x, y)} P \dif{u'} &= \int_{x(s)}^{x} R \dif{x'} \\
\int_{u(x(s), y(s))}^{u(x, y)} y \dif{u'} &= \int_{s}^{x} \frac{u_0x y }{l^2} \dif{x'} \\
\int_{f(s)}^{u(x, y)} 1 \dif{u'} &= u_0 \int_{s}^{x} \frac{x}{l^2} \dif{x'} \\
u(x, y) &= f\left(\sqrt{x^2+y^2}\right) + u_0 \left(\frac{x^2}{2l^2} - \frac{s^2}{2l^2}\right) \\
&= f\left(\sqrt{x^2+y^2}\right) - u_0 \frac{y^2}{2l^2}
\end{align*}
où nous avons utilisé le fait que $x^2+y^2=s^2$, afin d'éliminer $s$ de l'équation.

Considérons enfin le cas $R=u_0$. Il parait bien inoffensif, mais il ne l'est point. De nouveau, on intègre (cette fois avec la deuxième relation) :
\begin{align*}
Q \dif{u} &= R \dif{y} \\
-x \dif{u} &= u_0 \dif{y} \quad \text{ or, } x=\pm \sqrt{s^2-y^2} \\
\dif{u} &= -u_0 \frac{1}{ \pm \sqrt{s^2-y^2}} \dif{y} \\
\int_{u(x(s), y(s))}^{u(x, y)} \dif{u'} &= \int_{y(s)}^{y} -u_0 \frac{1}{\pm \sqrt{s^2-y'^2}} \dif{y'} \\
\int_{f(s)}^{u(x, y)} 1 \dif{u'} &= -u_0 \int_{0}^{y} \pm \frac{1}{ \sqrt{s^2-y'^2}} \dif{y'} \quad \quad + \text{ si } x>0 \; ; \, - \text{ sinon} \\
u(x, y) - f(s) &= u_0 \left[ \pm \arccos\left(\frac{y}{s}\right) \right]_{0}^{y}\\
&= \pm u_0 \left( \arccos\left(\frac{y}{\sqrt{x^2+y^2}}\right) - \frac{\pi}{2} \right) \quad \quad + \text{ si } x>0 \; ; \, - \text{ sinon} \\
&= \pm u_0 \left( \arcsin\left(\frac{x}{\sqrt{x^2+y^2}}\right) - \frac{\pi}{2} \right) \quad \quad + \text{ si } y>0 \; ; \, - \text{ sinon} % TODO vérifier que tous ces changements de valeurs et de signe sont corrects, c'est pas garanti.
\end{align*}
\footnote{{Un peu de trigonométrie pour démontrer le passage entre les deux dernières équations ne fait jamais de mal.}}et donc,% TODO mettre le développement
\[
u(x, y) = f\left(\sqrt{x^2+y^2}\right) + \begin{cases}
u_0 \left( \arcsin\left(\frac{x}{\sqrt{x^2+y^2}}\right) - \frac{\pi}{2} \right), & \text{si } y>0 \\
(-u_0) \left( \arcsin\left(\frac{x}{\sqrt{x^2+y^2}}\right) - \frac{\pi}{2} \right), & \text{sinon} \\
\end{cases}
\]
Quelques subtilités se cachent dans cet exemple. Tout d'abord, il faut exprimer $x$ en fonction de $y$ (car nous intégrons par rapport à $y$, et $s$ est une constante sur la caractéristique). Ensuite, il faut tenir compte des deux signes possibles pour $x$, et donc bien définir la fonction.
%FIXME : il est possible que j'aie fait une ou deux erreurs

\section{Équation de transport}
% TODO rajouter des graphes, et encore des graphes.

Un exemple classique d'EDP du premier ordre, unidimensionnel et dépendant du temps, est \emph{l'équation de transport} (ou équation de convection) :
\begin{equation}
\label{eq:order1-transport-ncgen}
c \fpart{u}{x} + \fpart{u}{t} = 0
\end{equation}
où $c$ a les dimensions d'une vitesse. L'équation de transport se retrouve dans des phénomènes physiques où une certaine quantité se transport dans l'espace, avec une vitesse $c$.

Il s'agit d'une EDP du premier ordre, avec $P=c$, $Q=1$ et $R=0$. La vitesse $c$ est, en toute généralité, une fonction de $x$, $t$ et même $u$. Le cas linéaire de l'EDP nécessite que $c=c(x, t)$ mais que $c$ ne dépende pas de $u$ (sinon, il y aurait un produit entre une fonction de $u$ et une dérivée partielle de $u$, et l'EDP ne serait plus linéaire). Comme $R=0$, $u$ est conservé le long des caractéristiques, qui sont données par intégration de $\dif{x}=c\dif{t}$.

Le domaine de l'équation de transport peut être borné ou non borné (ouvert) : un domaine borné est borné au niveau spatial, il y a des limites pour la valeur de $x$. Pour ce qui est de la \og condition initiale \fg{}\footnote{J'écris cette condition entre guillemets pour la différencier de la \og vraie \fg{} condition initiale, et qui est défini à la ligne d'après.} (la condition sur $u$ que l'on donne sur la courbe de Cauchy), on spécifie généralement $u$ sur la courbe de Cauchy définie par $\Gamma \equiv x(s)=s, t(s)=0$, et on donne $u(s, 0)=f(s)$. C'est alors une \emph{condition initiale}, une condition que l'on spécifie en un temps donné. L'intérêt des conditions initiales est avant tout pratique : lorsqu'on étudie un phénomène physique, on peut généralement déterminer ce phénomène à un instant donné (par des mesures par exemple), et on souhaite ensuite déterminer l'évolution de ce phénomène pour des instants ultérieurs.

Il se fait que quelle que soit la vitesse $c$, une telle condition initiale est bien posée : la direction locale des caractéristiques est donnée par $\frac{\dif{t}}{\dif{x}}=\frac{1}{c}\neq 0$\footnote{Ici, il est bien plus simple d'écrire la direction comme étant une certaine \emph{pente}, afin d'aider l'interprétation.}, tandis que la direction locale de la courbe de Cauchy est $\frac{\dif{t}}{\dif{x}}=0$. Physiquement, si on donne une condition initiale ainsi que la vitesse de déplacement de la quantité étudiée, on peut toujours calculer (parfois difficilement, comme on verra) l'état de cette quantité pour un instant $t>0$, simplement en suivant la vitesse. Le seul cas où une telle détermination est impossible, et où le problème est mal posé, survient quand $c \rightarrow \infty$ : la caractéristique et la courbe de Cauchy sont parallèles et confondues.

Commençons par étudier le cas le plus simple, avec $c$ constant. Dans ce cas, l'intégration des caractéristiques donne
\[ \int_{s}^{x} \dif{x'} = c \int_{0}^{t} \Leftrightarrow x-s=ct\]
et donc, $x(t)=ct+s$ pour un $s$ donné. Les caractéristiques sont des droites parallèles, et on a alors simplement
\[ u(x, t)=f(s)=f(x-ct) \]
La fonction initiale est simplement transportée à une vitesse constante $c$, sans aucune déformation. Mieux, la solution est aussi connue pour des $t$ négatifs : on peut connaitre le passé de la fonction !

Dans le cas $c$ constant, aurait-on pu spécifier une condition limite plutôt qu'une condition initiale ? Une condition limite est une condition sur $u(x, t)$ pour un $x$ fixé : on donne la valeur de $u$ sur une limite du domaine de la fonction (par exemple en $x=0$). Considérons donc $\Gamma' \equiv x(\tau)=0, t(\tau)=\tau$, sur laquelle on spécifie $u(0, \tau)=h(\tau)$, une autre fonction donnée. Cette fois, pour peu que $c\neq 0$, le problème est toujours bien posé : la direction locale de la courbe de Cauchy peut s'écrire comme $\frac{\dif{x}}{\dif{t}}=0$ tandis que la direction locale de la caractéristique est $\frac{\dif{x}}{\dif{t}}=c\neq 0$ (remarquez bien que la fraction a été inversée !). L'intégration des caractéristiques donne cette fois
\[ \int_{0}^{x} \dif{x'} = c \int_{\tau}^{t} \Leftrightarrow x=c(t-\tau) \Leftrightarrow \tau=t-\frac{x}{c}\]
qui sont toujours des droites parallèles, et la solution est donc
\[ u(x, t)=h(\tau)=h \left( t-\frac{x}{c} \right) \]

Si $c=0$, le problème est mal posé, et pour cause : plus rien ne se déplace vu que la vitesse est nulle, ce qui fait qu'une condition limite devient inutile et dangereuse ; inutile car elle ne spécifie pas la fonction $u$ ailleurs que sur la limite, et donc $u$ est inconnue partout ailleurs, et condamnée à ne jamais être connue en raison de la vitesse nulle et des caractéristiques mal orientée ; dangereuse car elle risque de spécifier plusieurs valeurs pour $u$ sur la limite, alors que $u$ n'y varie jamais (car la vitesse est nulle).

Si $c>0$, l'intuition nous dit que la fonction est translatée en direction des $x$ positifs, et les caractéristiques sont des droites dont la pente est positive ; par conséquent, on peut décider de considérer un domaine borné à gauche (on dit aussi semi-borné) $0 \le x < \infty$. Il est alors nécessaire de spécifier deux conditions : une condition initiale de la fonction et $t=0$, qui va nous permettre de calculer $u(x, t)$ $\forall x, t$ tels que $x-ct\ge 0$ (sur un graphique $(x, t)$ avec $x$ en abscisse, ce sont les points en dessous de l'axe $x=ct$, qui est la caractéristique issue de $s=0$), \emph{et} une condition limite en $x=0$, qui va nous permettre de calculer $u$ pour les autres points. Pourquoi deux conditions limites ? Parce que le fait de borner le domaine à gauche \og élimine \fg{} la connaissance de $u$ pour $x<0$, et donc la connaissance de $u$ pour tous les points $(x, t)$ qui appartenaient à une caractéristique pour laquelle $s<0$. Il faut donc retrouver cette connaissance, en spécifiant par exemple une condition en $x=0$, de sorte que les caractéristiques issues de cette condition \og propagent \fg{} la valeur de $u$ sur l'ensemble du domaine. On spécifie alors deux fonctions, $u(s, 0)=f(s)$ pour $s\ge 0$ et $u(0, \tau)=h(\tau)$ pour $\tau>0$, et on sépare la solution en deux cas, par exemple :
\[u(x, t) = \begin{cases}
f(x-ct) & \text{si } x-ct>0 \\
h \left(t-\frac{x}{c} \right) \text{sinon} \\
\end{cases}\]

Pour $c>0$, aurait-on pu décider de spécifier une deuxième condition limite, en $x=L>0$, de sorte que l'on ait un domaine borné à gauche et à droite ? La réponse est non \footnote{Du moins, dans le cas $c$ constant ; si $c$ est tarabiscoté, il est possible que ce soit possible.}. La valeur de $u$ en $x=L$ est en effet entièrement définie par ce qui vient de la gauche : les caractéristiques transportant de l'information, on ne peut pas spécifier deux conditions sur une même caractéristiques, et comme les caractéristiques transportent l'information vers la droite, la valeur de $u(L, t)$ est déjà spécifiée.

Tient, et si $c<0$, et que l'on considère un domaine borné à gauche ($0\le x < \infty$) ? Que se passe-t-il, que peut-on imposer ? Les caractéristiques sont alors des droites à pente négative, qui transmettent de l'information vers la gauche quand on avance dans le temps. Il suffit alors de spécifier une seule condition, par exemple une condition initiale $u(s, 0)=f(s), s\ge 0$, pour que $u$ soit connu $\forall x, t \ge 0$. Cela vient du fait que $s=x-ct\ge 0$ pour n'importe quels $x$ et $t$ du domaine choisi, et la condition initiale peut donc être utilisée partout. Une condition limite en $x=0$ peut également être utilisée partout. Par contre, pour des temps négatifs, il est de nouveau nécessaire de spécifier une deuxième condition. Intuitivement, la condition initiale se déplace vers la gauche, et atteint donc tous les points du plan.

Comme on l'a dit, l'équation de transport modélise un déplacement dans le temps d'une quantité selon une vitesse $c$. On peut donc être intéressé de savoir ce qu'une observatrice
\footnote{C'est plus facile pour les pronoms par après.}
verrait au cours du temps et au cours du déplacement de cette quantité. Considérons donc une observatrice qui se déplace, indépendamment de la quantité étudiée (mettons un train)
\footnote{Après tout, un train est aussi une quantité physique, qui obéit à l'équation de transport.}
selon une loi $x_p(t)$. Elle voit donc, à tout instant, une valeur de $u$ égale à $u_p(t)=u(x_p(t), t)$. La variation de $u$ dans le temps qu'elle perçoit est donnée par la règle de la chaine :
\[ \fdif{}{t} u(x_p(t), t) = \fpart{u}{x} \cdot \fdif{x_p}{t} + \fpart{u}{t} \]
En comparant avec notre EDP,
\[ 0=\fpart{u}{x} \cdot c + \fpart{u}{t} \]
on voit que si elle se déplace exactement à la vitesse $c$, la variation de $u$ est nulle : comme elle accompagne le mouvement, aucun changement n'est visible.

On peut établir des relations encore plus intéressantes en étudiant la vitesse de l'observatrice, $c_p(t)=\fdif{x_p}{t}(t)$.
Si, à un certain instant $t$, elle ne se déplace pas ($c_p=0$), la variation de $u$ vue par l'observatrice est exactement la variation de $u$ à cet endroit : si elle est en train de filmer un train se déplaçant à vitesse constante, elle aura l'ensemble de l'histoire du passage du train.
Si l'observatrice se déplace exactement à la vitesse du train, elle aura une image fixe. Si elle se déplace à des vitesse différentes, elle enregistrera un déplacement du train à une vitesse moins grande, ou en sens inverse.
L'ensemble de ces remarques sont également applicables à des cas où $c$ ou $c_p$ ne sont pas constants : seule la vitesse instantanée importe dans ce cas. L'équation de transport et la méthode des caractéristiques se retrouvent dans la vraie vie.
%TODO développer

Considérons maintenant le cas où $c=c(x, t)$ ; cette fois, il faut intégrer une relation qui peut être parfois assez complexe. Commençons par un cas où $c=c(x)=\frac{x}{\tau}$ par exemple, et où on considère une condition initiale $u(s, 0)=f(s)$. L'intégration donne
\begin{align*}
\int_{s}^{x} \frac{\dif{x'}}{x'} &= \int_{0}^{t} \frac{\dif{t'}}{\tau} \\
\ln \left( \frac{x}{s} \right) &= \frac{t}{\tau} \\
x &= s e^{t/\tau} \\
s &= x e^{-t/\tau}
\end{align*}
Les caractéristiques sont des courbes exponentielles, et la fonction initiale va donc être déformée. En effet, la solution est
\[ u(x, t)=f(x e^{-t/\tau}) \]

Ce problème était encore relativement simple, la fonction à intégrer étant gentille. Les choses sont rarement aussi idéales. Considérons par exemple $c=c(x)=c_0 \frac{x^2}{x^2+L^2}$, avec $L$ une constante ayant les mêmes dimensions que $x$ (donc, une constante de longueur). Il s'agit d'intégrer
\begin{align*}
c(x) \dif{t} &= 1 \dif{x} \\
\int_{x'=s}^{x'=x} \frac{1}{c} \dif{x'} &= \int_{t'=0}^{t'=t} \dif{t'} \\
\int_{s}^{x} \frac{1}{c_0} \frac{x'^2+L^2}{x'^2} \dif{x'} &= t \\
\left[ x'-\frac{L^2}{x'} \right]_s^x &= c_0 t \\
x-s +L^2 \left(\frac{1}{s} - \frac{1}{x} \right) &= c_0t
\end{align*}
qui est une relation implicite entre $x$, $t$ et $s$. On peut déterminer $s$ en résolvant l'équation du second degré suivante (qui n'est autre qu'une réécriture de la précédente relation) :
\[ s^2 + \left( \frac{L^2}{x} - x + C_0 t \right) - L^2 = 0 \]
Comme on voit, la valeur de $s$ peut être particulièrement compliquée à obtenir. Dans l'APE 2, $c=c(x)=C_0\frac{x^2+(L/2)^2}{x^2+L^2}$ conduit même à résoudre l'équation transcendante
\[ x-s + \frac{3L}{2} \arctan \left( \frac{2L(x-s)}{L^2+4xs} \right) =c_0t\]
pour obtenir $s$.

En toute généralité et pour une condition initiale, si $c=c(x)$, l'intégration donne
\[\int_{s}^{x} \frac{\dif{x'}}{c(x')} = \int_{0}^{t} \dif{t'} = t\]
et, en posant $I(x)=\int_{0}^{x} \frac{\dif{x'}}{c(x')}$\footnote{Comme il s'agit d'une sorte de primitive (la borne inférieure $0$ étant arbitraire), on écrit parfois cette intégrale en omettant la borne inférieur ; c'est alors une primitive, définie à une constante près.},
\[ I(x)-I(s)=t \]
$t$ est alors fonction de $x$ par le biais de la \og primitive \fg{} $I(x)$.

Considérons le cas où $c=c(t)$, et considérons toujours le problème posé en condition initiale. En toute généralité, l'intégration donne cette fois
\[ \int_{s}^{x} \dif{x'} = \int_{0}^{t} c(t') \dif{t'} = x - s\]
et, en posant $H(t)=\int^{t} c(t') \dif{t'}$,
\[ x-s = H(t)-H(0) \]
\[ t=H^{-1} (x-s+H(0)) \]
Pour un temps $t$ fixé, l'écart $x-s$ (entre la position actuelle et la position de départ) est le même quel que soit ce point, et l'écart entre deux points de la courbe initiale est donc constante. Les caractéristiques obtenues sont alors des courbes parallèles (par rapport à l'axe de l'espace) : la fonction $u$ est transportée sans être déformée.
\footnote{C'est assez difficile à se l'imaginer, mais on peut interpréter cela ainsi : la vitesse change au cours du temps, mais elle change \emph{de la même manière} pour tous les points de la courbe. Et donc, la forme de la courbe initiale est conservée, de la même manière qu'une voiture ne se déforme pas tant que la vitesse de chaque point est identique, même si elle accélère.}

Prenons $c(t)=\frac{l}{t+\tau}$, $l$ étant une constante de longueur et $\tau$ une constante de temps. L'intégration donne :
\begin{align*}
\int_{s}^{x} \dif{x'} &= \int_{0}^{t} \frac{l}{t'+\tau} \dif{t'} \\
x-s &= l \left( \ln(t+\tau) - \ln(0+\tau)\right) \\
\frac{x-s}{l} &= \ln\frac{t+\tau}{\tau} \\
s &= x - l \ln\left(1+t/\tau \right)
\end{align*}
ce qui donne finalement comme solution
\[u(x, t)=f\left( x - l \ln(1+t/\tau )\right)\]

Les équations pour lesquelles $c$ est une fonction ont des règles similaires quant aux conditions qui peuvent être posées pour former un problème de Cauchy complet et cohérent. En particulier, si $c=0$ en un point à un instant, la valeur de la fonction reste immobile : rien ne bouge. Si $c>0$, la valeur se déplace vers les $x$ positifs, et si $c<0$, vers les $x$ négatifs. La seule différence vient du fait que $c$ étant une fonction, il est possible que des points qui sont immobiles deviennent soudainement mobiles, et que le comportement de la fonction soit plus difficile à analyser.

On peut également déterminer si un problème est bien posé, en fonction des conditions initiales et limites données. La majorité des problèmes possèdent une condition initiale, la plus simple à déterminer et à utiliser. Pour des vitesses finies, le problème de Cauchy est toujours bien posé. Pour des vitesses non finies, le problème est mal posé si la vitesse devient infinie sur la courbe de Cauchy\footnote{Le problème a aussi de fortes chances de ne pas être résoluble.}.

Dans ce cas, à quelles conditions peut-on donner une condition limite, en particulier une condition à gauche (par exemple, en $x=0$, de sorte que le domaine devient borné à gauche, avec $0 \le x < \infty$) ? Uniquement si cette condition n'est pas redondante. Et pour déterminer cela, on utilise la pente locale de la caractéristique, $\fdif{x}{t}$. Si cette pente est négative, la caractéristique est dite sortante (elle sort du domaine) et l'information concernant la valeur de la fonction vient de l'intérieur du domaine, à droite, et est donc déjà imposée. On ne peut donc pas donner de condition. Si la pente est positive, et la caractéristique entrante, l'information vient de la gauche, et donc de l'extérieur ; il faut donc donner la condition limite, sinon une partie du domaine ne sera pas défini. Si la pente est nulle, on ne peut pas non plus spécifier de caractéristique, et si elle est infinie, on doit le faire.

Ces conditions ne sont valables que dans le cas d'un domaine du type $0 \le x < \infty$ et $0 \le t < \infty$. Dans les autres cas, des critères similaires peuvent être établis, avec le même impératif : la non-redondance. Un croquis du domaine et de ses caractéristiques permet souvent de s'y retrouver.

\section{Équation de transport sous forme conservative}

Une variante de l'équation de transport est l'équation de transport sous forme conservative :
\begin{equation}
\label{eq:order1-transport-consgen}
\fpart{cu}{x} + \fpart{u}{t} = 0
\end{equation}
La vitesse $c$ est à l'intérieur de la dérivée partielle par rapport à $x$. Dans le cas où $c$ n'est pas une fonction de $x$ (par exemple, $c=c(t)$, ou $c$ est constant), on retombe sur l'équation de transport de la section précédente.

Comme d'habitude, on considère un problème posé en condition initiale ($x(s)=s$, $t(s)=0$, et $u(s, 0)=f(s)$). Le domaine peut être soit non borné (ouvert), soit périodique (de période $L$).

L'équation tire son nom du fait qu'elle conserve l'intégrale de la fonction dans le temps. En effet, en notant $\Omega$ le domaine et $\partial \Omega$ son bord, on a
\begin{align*}
\fdif{}{t} \left( \int_\Omega u \dif{x} \right) &= \int_\Omega \fpart{u}{t} \dif{x} \\
&= - \int_\Omega \fpart{}{x}(cu) \dif{x} \\
&= - \left[ cu \right]_{\partial \Omega}
\end{align*}
Il s'agit alors de calculer ce terme. Or, dans le cas d'un domaine périodique, la fonction et la vitesse sont périodiques, ce qui donne
\[-\left[cu\right]_x^{x+L} = -c(x+L)u(x+L) + c(x)u(x) = -c(x)u(x)+c(x)u(x)=0\]
Si le domaine est infini en revanche, on a que $\lim\limits_{x\rightarrow \pm \infty} u = 0$ et $c$ garde une valeur finie. Rappelons que l'on cherche la solution d'un problème d'origine physique : dans le monde réel, peu de quantité tendent vers l'infini, et donc il faut que l'intégrale de $u$ ait aussi une valeur finie, même dans un domaine infini ; cela implique que $u$ s'approche de $0$ à l'infini. Et donc,
\[ -\left[ cu \right]_{-\infty}^{+\infty} = -0+0=0\]
Par conséquent, l'intégrale ne varie pas dans le temps, et la fonction est conservée. Cette affirmation n'est plus vraie si $u$ est discontinue ou possède des singularités ; dans ce cas, l'intégrale a tendance à varier.
\footnote{Il peut arriver que l'on étudie un problème qui n'a pas d'origine physique.} Les phénomènes où la quantité globale est conservée sont assez fréquent en pratique.

Autant l'intégrale de $u$ sur le domaine est conservée dans le temps, autant $u$ lui même n'est plus conservé le long des caractéristiques. En effet, en développant l'équation,
\[c \fpart{u}{x} + \fpart{u}{t} = -u \fpart{c}{x}\]
on constate que $R\neq 0$. Le long des caractéristiques, la variation de $u$ est donnée par
\[ \dif{u} = -u \fpart{c}{x} \dif{t} \]

Considérons le cas où $c=c(x)$ (c'est le cas le plus fréquent : un transport dans un milieu non homogène, avec des vitesse locales différentes). Dans ce cas, on peut écrire, via la relation des caractéristiques, que $\dif{t} = \frac{1}{c} \dif{x}$ (les dérivées partielles deviennent des dérivées simples) et donc, la relation de compatibilité devient
\[ \dif{u} = -u \fdif{c}{x} \frac{1}{c} \dif{x} \]
\[\Leftrightarrow c \dif{u} + u \dif{c} = \dif{(cu)} = 0\]
Par conséquent, $cu$ est conservé le long de chaque caractéristique ! Le développement complet nous aurait amené à la même conclusion, et on a donc
\[u(x, t) = \frac{c(s)}{c(x)} u(s, 0)=\frac{c(s)}{c(x)} f(s)\]
avec $s$ qui peut être obtenu à partir de la relation caractéristique. Les équations de transport conservatives sont donc à peine plus compliquées que les équations non-conservatives.

%Est-ce qu'une autre quantité est conservée ? Peut-être l'énergie $u^2/2$ :
%\footnote{Ici, $a=-\infty$ et $b=+\infty$ pour un domaine ouvert, et $a=x$ et $b=x+L$ pour un domaine périodique.}
%\begin{align*}
%\fdif{}{t} \int_{a}^{b} \frac{u^2}{2} \dif{x} &= \int_{a}^{b} \fdif{}{t} \left( \frac{u(x, t)^2}{2} \right) \dif{x} \\
%&=
%\end{align*}

Un cas intéressant est celui du puits de vitesse. La vitesse s'exprime alors
\begin{align*}
c(x) &= c_\mathrm{max} - \frac{c_\mathrm{max}-c_\mathrm{min}}{1+x^2/a^2} \\
&= \frac{c_\mathrm{min}+c_\mathrm{max}x^2/a^2}{1+x^2/a^2} \\
&= \frac{a^2 c_\mathrm{min} + x^2 c_\mathrm{max}}{x^2+a^2}
\end{align*}
La vitesse présente un minimum en $x=0$. La fonction $u$ est alors déformée lors du passage au niveau du puits de vitesse ; en entrant dans le puits, la vitesse diminue, ce qui implique que la valeur de la fonction augmente dans le puits, l'intégrale devant être conservée. En sortant du puits, la vitesse augmente et la fonction diminue à nouveau. On a donc une sorte de \og sursaut \fg{} de la fonction à l'intérieur de la vitesse.

%TODO équations non linéaires
%TODO équation de Burgers
%TODO discontinuités

\section{Le problème inverse de Cauchy : à la recherche de l'EDP (ou l'examen de septembre 2016)}
% TODO rajouter des graphes

Lors de ce chapitre, nous avons vu comment résoudre les EDP du 1\ier{} ordre à l'aide de la méthode des caractéristiques. À partir de l'équation \ref{eq:order1-genequa}, nous avons développé la méthode des caractéristiques qui nous permet de résoudre ces EDP, lorsqu'une condition est donnée sur une courbe $\Gamma$. Le c\oe{}ur de cette méthode est le calcul de l'équation des caractéristiques, à partir de la relation caractéristique
\begin{equation*}
P \dif{y} = Q \dif{x} \tag{\ref{eq:order1-caractode}}
\end{equation*}
et en intégrant la relation, selon l'équation \ref{eq:order1-caractcurve_integral}.

À partir d'une EDP, on peut donc construire un réseau de courbes caractéristiques, qui peuvent être utilisées pour propager la valeur de $u$ dans l'ensemble du plan, à partir de la courbe de Cauchy. Cela semble assez vraisemblable. Néanmoins, par le plus grand des hasards, serait-il possible d'emprunter le chemin inverse, de partir d'un réseau de caractéristiques et obtenir une EDP valable ? Cela semble invraisemblable et peu probable. Et pourtant, la réponse est oui !

Il y a une sorte de bijection entre les EDP du premier ordre d'une part, et les réseaux de caractéristiques d'autre part : le lien entre les deux est la relation différentielle $P \dif{y} = Q \dif{x}$. Le chemin classique a déjà été abordé dans les sections précédentes ; il est temps de montrer le chemin inverse.
\footnote{Pour l'anecdote, les professeurs utilisent généralement ce chemin inverse pour trouver leurs énoncés d'EDP ; très souvent, partir d'une EDP choisie au hasard et tenter de trouver le réseau correspondant résulte dans une impasse, avec des intégrales non calculables ou difficiles et des développements algébriques lourds, parce que les EDP ont rarement un comportement gentil. C'est plus sûr de partir d'un réseau connu et de tenter d'obtenir une EDP ayant ce réseau : au moins, on peut prédire visuellement le résultat.}

L'exemple le plus classique (et à vrai dire le seul) de ce type de question est l'examen de septembre 2016. Il avait causé une assez grande hécatombe, et est représentatif du raisonnement. Voici l'énoncé.

\begin{quotation}
	On considère l'EDP suivante pour $u(x, y)$ :
	\[ P \fpart{u}{x} + Q \fpart{u}{y} = R \]

	Pour le problème de Cauchy, la courbe $\Gamma$ est l'arc de cercle défini par $x(s)=r_0 \cos(s)$ et $y(s)=r_0 \sin(s)$ avec $r_0$ donné et $-\frac{\pi}{2} \le s \le \frac{\pi}{2}$. On donne également $u(x(s), y(s)) = u_0 \sin^3 (s)$.

	L'équation des caractéristiques est de la forme :
	\[ r=L\theta + B(r_0, s) \]
	avec $r$ le module et $\theta$ la position angulaire du point $(x, y)$ : $x=r\cos \theta$ et $y=r\sin\theta$.

	\begin{enumerate}
		\item Obtenez l'expression de $B(r_0, s)$, et donc d'équation finale des caractéristiques. Esquissez alors la courbe $\Gamma$ ainsi que le réseau des caractéristiques, et ce pour $0\le r \le 2r_0$ et $s=0$ et $s=\frac{\pi}{4}$. On utilisera ici $\frac{r_0}{L}=\frac{\pi}{4}$ pour l'esquisse.
		\item Par différenciation de l'équation des caractéristiques, obtenez les fonctions $P(x, y)$ et $Q(x, y)$ du problème présent.
		\item On considère le cas $R=0$ ; obtenez l'expression de $u(\sqrt{2}r_0, \sqrt{2}r_0)$.
	\end{enumerate}
\end{quotation}

Récapitulons ce que nous savons et ce que nous ignorons : nous connaissons la courbe de Cauchy, une expression non complète des caractéristiques, ainsi que $u(s)$. Nous ne connaissons pas par contre les coefficients $P$ et $Q$ ; ce sont eux que l'on veut retrouver ! Il va donc falloir compléter le problème, et utiliser l'ensemble des informations disponibles pour le résoudre.

La résolution commence par trouver l'expression complète des caractéristiques. Pour le moment, on sait qu'elles sont de la forme $r=L\theta + B(r_0, s)$ mais on ne connait pas $B$. L'expression des caractéristiques contient deux termes : un terme $L\theta$ qui varie le long d'une des caractéristiques, et qui va nous donner une partie de $r$, et le terme $B(r_0, s)$ qui est une constante pour chaque caractéristique.

L'expression des caractéristiques définit une famille de courbes appelées spirales d'Archimède : il s'agit de courbes de la forme d'hélice, tournant autour de l'origine et s'étendant à l'infini.
\footnote{Malheureusement, ça faisait partie de la culture générale qu'il fallait apparemment avoir à l'examen...}

Comment calculer $B$ ? Rappelons \strong{la} propriété fondamentale des caractéristiques d'un problème bien posé : elles croisent la courbe de Cauchy une et une seule fois. Cherchons donc le point d'intersection entre la caractéristique définie par un certain $s$ et la courbe de Cauchy. Ce point n'est rien d'autre que le point de la courbe de Cauchy pour le paramètre $s$ : les caractéristiques émanent de ce point. Or, pour un $s$ donné, le point de la courbe de Cauchy a pour coordonnées $(x(s), y(s)) = (r_0 \cos\theta, r_0\sin\theta)$ ou, en coordonnées polaires, $(r_0 ; s)$ : il est sur le cercle ($r=r_0$) et est son propre argument.

Ce point, $(r_0; s)$, doit appartenir à la caractéristique définie par ce $s$, et on doit donc avoir, pour $r=r_0$ et $\theta=s$ :
\[ r_0=Ls+B(r_0, s) \quad \Rightarrow \quad B(r_0, s) = r_0-L\cdot s \]
et les caractéristiques ont donc comme équation générale
\begin{equation}
\label{eq:order1-2016sept-caractequafinal}
(r-r_0) = L (\theta - s)
\end{equation}

Rappelons la démarche : on sait que la caractéristique définie par $s$ coupe la courbe de Cauchy au point de cette courbe défini par $s$. L'égalité des coordonnées donne une relation entre les deux, qui nous permet de calculer $B(r_0, s)$.

% FIXME Ligne d'après : overfull hbox 1.30pt too wide
Déterminons à présent $P$ et $Q$. L'objectif à présent est d'obtenir une expression de la forme $f(x, y) \dif{y} = g(x, y) \dif{x}$, pour laquelle on pourra dire $P=f$ et $Q=g$. Pour cela, on nous propose de différencier notre équation des caractéristiques. Faisons-le :
\begin{align*}
r-r_0 &= L(\theta-s)
\shortintertext{En différenciant} \\
\dif{r} &= L \dif{\theta}
\shortintertext{En utilisant la règle de la chaine} \\
\fpart{r}{x} \dif{x} + \fpart{r}{y} \dif{y}
&= L \fpart{\theta}{x} \dif{x} + L \fpart{\theta}{y} \dif{y}
\shortintertext{Avec $r=\sqrt{x^2+y^2}$ et $\theta=\arctan(y/x)$} \\
\fpart{}{x} (\sqrt{x^2+y^2}) \dif{x} + \fpart{}{y} (\sqrt{x^2+y^2})
&= L \fpart{}{x} \arctan\left(\frac{y}{x}\right) \dif{x} + L \fpart{}{y} \arctan\left(\frac{y}{x}\right) \dif{y} \\
\frac{1}{2\sqrt{x^2+y^2}} 2x\dif{x} + \frac{1}{2\sqrt{x^2+y^2}} 2y\dif{y}
&= L \frac{1}{1+\frac{y^2}{x^2}} \cdot \left(\frac{-y}{x^2}\right) \dif{x}
+ L \frac{1}{1+\frac{y^2}{x^2}} \cdot \frac{1}{x} \dif{y} \\
\frac{x}{\sqrt{x^2+y^2}} \dif{x} + \frac{y}{\sqrt{x^2+y^2}} \dif{y}
&= L \frac{x^2}{x^2+y^2} \frac{-y}{x^2} \dif{x} + L \frac{x^2}{x^2+y^2} \frac{1}{x} \dif{y} \\
\frac{x}{r} \dif{x} + \frac{y}{r} \dif{y} &= \frac{-yL}{r^2} \dif{x} + \frac{xL}{r^2} \dif{y} \\
\left(\frac{x}{r} + \frac{yL}{r^2} \right) \dif{x} &= \left(\frac{xL}{r^2} - \frac{y}{r}\right) \dif{y}
\shortintertext{En multipliant par $r$ (unités)} \\
\left( x + \frac{yL}{\sqrt{x^2+y^2}} \right) \dif{x} &= \left( \frac{xL}{\sqrt{x^2+y^2}} - y \right) \\
\end{align*}
et donc, on obtient la valeur de $P$ et $Q$ :
\begin{equation}
\label{eq:order1-2016sept-pq}
P=\frac{xL}{\sqrt{x^2+y^2}} - y \quad \text{et} \quad Q=\frac{yL}{\sqrt{x^2+y^2}} + x
\end{equation}

On connait dès lors l'ensemble du problème de Cauchy, et il ne reste plus qu'à calculer la solution quand $R=0$. Il suffit d'exprimer $s$ en fonction de $r$ et $\theta$ à l'aide de \ref{eq:order1-2016sept-caractequafinal}, d'utiliser la valeur de $u(s)$, et de voir ce qu'il se passe quand $r=2r_0$ et $\theta=\frac{\pi}{4}$ (les calculs sont plus simples en coordonnées polaires).

Que retenir de tout cela ? Une caractéristique pour une valeur $s_1$ croise la courbe de Cauchy en un seul point, qui est le point de la courbe de Cauchy pour $s=s_1$ ; cela permet de compléter l'équation. Ensuite, à partir de l'équation des caractéristiques, on différencie et on utilise au besoin la règle de la chaine ou d'autre relations pour finalement arriver à $P$ et $Q$.

%TODO rajouter un autre exemple

%TODO Systèmes d'EDP du premier ordre

%  /======================================================\
% |                                                       %|
  \chapter{Les EDP du second ordre}                       %|
% |                                                       %|
%  \======================================================/

Après avoir vu les EDP du premier ordre, emmenons nos Stormtroopers sur une nouvelle planète : les EDP du second ordre\footnote{On dit aussi, plus correctement, du deuxième ordre.}, qui vont nous intéresser pendant le reste de ce document.\footnote{Oui, j'ai craqué.}

Les EDP du second ordre contiennent des dérivées d'ordre 2 de la fonction que l'on recherche. L'EDP la plus générale du deuxième ordre et à deux variables indépendantes est
\begin{equation}
\label{eq:order2-genequa}
A \ffpart{\phi}{x} + B \fdpart{\phi}{x}{y} + C \ffpart{\phi}{y} = R
\end{equation}
où $A, B, C, R$ sont fonctions au plus de $x$, $y$, $\phi$, $\fpart{\phi}{x}$ et $\fpart{\phi}{y}$, mais pas d'une dérivée seconde de $\phi$.

Cette EDP est quasi-linéaire, c'est-à-dire linéaire par rapport aux dérivées du plus haut ordre en chacune des variables, et c'est le moment rêvé d'expliquer ce que cela signifie. La linéarité signifie que toute combinaison linéaire de deux solutions $\phi_1$ et $\phi_2$ est également une solution, lorsqu'on l'injecte dans l'équation : comme les opérateurs de dérivation sont linéaires, la linéarité doit s'appliquer à chaque terme de l'équation contenant la fonction $\phi$ ou ses dérivées, et les différentes apparitions de la fonction $\phi$ doivent être linéaires. La quasi-linéarité retire cette contrainte, en ignorant la linéarité de toutes les dérivées à part les plus élevées : en gros, les termes contenant les dérivées du plus haut ordre ($\ffpart{\phi}{x}$, $\fdpart{\phi}{x}{y}$ et $\ffpart{\phi}{y}$) sont linéaires, et on considère uniquement ceux-là. Cela signifie qu'une combinaison linéaire $a \cdot \left(\ffpart{\phi}{x}\right)_1 + b \cdot \left(\ffpart{\phi}{x}\right)_2$ est bien \og solution \fg{} de l'EDP, en ignorant les autres dérivées de $\phi$ comme s'il s'agissait de constantes ou d'autres fonctions.
\footnote{Si le paragraphe n'est pas très clair, ne vous inquiétez pas : retenez juste la définition de la quasi-linéarité, ainsi que la forme générale de l'équation, et normalement tout ira bien.}
Dans notre équation \ref{eq:order2-genequa}, on voit que les termes d'ordre 2 ont comme coefficients des fonctions $A, B, C, R$ qui ne sont pas fonctions des dérivées d'ordre 2, mais bien des dérivées d'ordre 1 au plus. En supposant que l'on considère les fonctions $\phi$, $\fpart{\phi}{x}$ et $\fpart{\phi}{y}$ comme constantes ou comme fonctions indépendantes des dérivées secondes, alors une combinaison linéaire des dérivées secondes sera décomposée comme étant linéaire. Encore en d'autres symboles, considérons $\phi_0$, $\phi_1$ et $\phi_2$, et considérons uniquement le terme en $\ffpart{\phi}{x}$ :\footnote{Le duo de parenthèses après le $A$ servent à rappeler que c'est une fonction de ces paramètres, le duo de parenthèses suivantes sont simplement pour délimiter un facteur.}
\begin{align*}
& A\left(x, y, \phi_0, \fpart{\phi_0}{x}, \fpart{\phi_0}{y}\right) \cdot \left(a \cdot \ffpart{\phi_1}{x} + b \cdot \ffpart{\phi_2}{x}\right) \\
&= A\left(x, y, \phi_0, \fpart{\phi_0}{x}, \fpart{\phi_0}{y}\right) \cdot a \cdot \ffpart{\phi_1}{x} + A\left(x, y, \phi_0, \fpart{\phi_0}{x}, \fpart{\phi_0}{y}\right) \cdot b \cdot \ffpart{\phi_2}{x} \\
&= a \cdot \left( A\left(x, y, \phi_0, \fpart{\phi_0}{x}, \fpart{\phi_0}{y}\right) \cdot \ffpart{\phi_1}{x}\right) + b \cdot \left( A\left(x, y, \phi_0, \fpart{\phi_0}{x}, \fpart{\phi_0}{y}\right) \cdot \ffpart{\phi_2}{x}\right) \\
\end{align*}
%FIXME si quelqu'un a une meilleure manière d'expliquer la quasi-linéarité, qu'il n'hésite pas à l'écrire ici !

Traditionnellement, on utilise $\phi$ et non $u$ comme fonction inconnue pour les équations du second ordre. Notons que $R$ peut généralement décomposé en $R\left(x, y, \phi, \fpart{\phi}{x}, \fpart{\phi}{y}\right) = F(x, y) + G\left( x, y, \phi, \fpart{\phi}{x}, \fpart{\phi}{y} \right)$ où $G$ dépend toujours de $\phi$ ; $G$ est \og homogène \fg{} en $\phi$.

Les EDP du second ordre \emph{linéaires} ont par contre la forme suivante
\begin{equation}
\label{eq:order2-genequalin}
A \ffpart{\phi}{x} + B \fdpart{\phi}{x}{y} + C \ffpart{\phi}{y} + P \fpart{\phi}{x} + Q \fpart{\phi}{y} + G \phi =F
\end{equation}
où $A, B, C, P, Q, G, F$ sont au plus des fonctions de $x$ et $y$, mais pas de $\phi$ ou d'une de ses dérivées.

Terminons cette petite introduction en indiquant que ces EDP sont homogènes ssi $F=0$.

\section{Problème de Cauchy et méthode des caractéristiques}

Comme on l'a vu à la section précédente, la méthode des caractéristiques s'avère extrêmement puissante pour résoudre des EDP du premier ordre, malgré son côté un peu (beaucoup) calculatoire. Elle permet -- en théorie -- de résoudre l'ensemble des équations du premier ordre. Dès lors, on aimerait bien pouvoir utiliser la méthode des caractéristiques pour résoudre les équations du second ordre.

Pour cela, posons de nouveau notre \emph{problème de Cauchy} : on se donne une EDP du deuxième ordre, linéaire ou quasi-linéaire, ainsi qu'une courbe paramétrée $\Gamma \equiv (x(s), y(s))$ sur laquelle on spécifie deux informations : la valeur de la fonction $\phi(s)$ ainsi que la valeur de la dérivée par rapport à la normale, $\fpart{\phi}{n}(s)$. Il est nécessaire de spécifier deux conditions pour que le problème n'ait qu'une solution. On notera $n(s)$ la normale à la courbe, qui est un réel. %FIXME c'est pas très clair
La question désormais est de savoir si l'on peut construire, à partir de ces informations, la solution de l'EDP au voisinage de la courbe $\Gamma$. Si c'est le cas, on pourra étendre cette construction pour couvrir l'ensemble du plan et donc, déterminer la solution $\phi$. Cela ressemble à la méthode vue pour les EDP du premier ordre. Et comme on va le voir, ce sera beaucoup plus difficile...

Commençons par établir la liste des relations que l'on connait au sujet de notre courbe et de notre fonction. On connait $\phi(s) = f(s)$ le long de la courbe $\Gamma(s) \equiv (x(s), y(s))$, et donc on connait $\fpart{\phi}{s}(s) = f'(s)$. Grâce à $\fpart{\phi}{n}(s)$, la dérivée normale à la courbe, on connait $\grad \phi(s) = \left(\fpart{\phi}{x}(s), \fpart{\phi}{y}(s)\right)$ (le gradient de $\phi$ le long de $\Gamma$). %\footnote{Plus en détail, \[ \fpart{\phi}{x}(x(s)) = \fpart{\phi}{s}(s) \fpart{s}{x}(x) \]}.
Enfin, les dérivées de chaque terme du gradient, $\fpart{}{s} \left(\fpart{\phi}{x}\right)$ et $\fpart{}{s} \left(\fpart{\phi}{y}\right)$ sont également connus le long de $\Gamma$. On peut ainsi écrire (similairement à l'équation \ref{eq:order1-duds}) :
\begin{equation}
\label{eq:order2-dphidxs}
\fpart{}{x} \left(\fpart{\phi}{x}\right) \cdot \fdif{x}{s} + \fpart{}{y} \left(\fpart{\phi}{x}\right) \cdot \fdif{y}{s} = \fdif{}{s} \left(\fpart{\phi}{x}\right)
\end{equation}
et
\begin{equation}
\label{eq:order2-dphidys}
\fpart{}{x} \left(\fpart{\phi}{y}\right) \cdot \fdif{x}{s} + \fpart{}{y} \left(\fpart{\phi}{y}\right) \cdot \fdif{y}{s} = \fdif{}{s} \left(\fpart{\phi}{y}\right)
\end{equation}
et de la même manière, on peut tout mettre en notation matricielle (similaire à \ref{eq:order1-bienpose-edp-duds})
\begin{equation}
\label{eq:order2-bienpose-edp-dphidxys}
\begin{pmatrix}
A & B & C \\ \fdif{x}{s} & \fdif{y}{s} & 0 \\[0.5 em] 0 & \fdif{x}{s} & \fdif{y}{s}\\
\end{pmatrix}
\begin{pmatrix}
\ffpart{\phi}{x} \\[0.5 em] \fdpart{\phi}{x}{y} \\[0.5 em] \ffpart{\phi}{y} \\
\end{pmatrix}
=\begin{pmatrix}
R \\ \fdif{}{s} \left(\fpart{\phi}{x}\right) \\[0.5 em] \fdif{}{s} \left(\fpart{\phi}{y}\right) \\
\end{pmatrix}
\end{equation}

Tant que le déterminant de ce système ne s'annule pas, on peut le résoudre et donc obtenir la valeur des trois dérivées partielles secondes. On peut dès lors calculer $\phi$ et ses dérivées premières à l'aide des relations suivantes
\begin{subequations}
\label{eq:order2-propag-all}
\begin{align}
\phi(x+\dif{x}, y+\dif{y}) &= \phi(x, y) + \dif{x} \fpart{\phi}{x} (x, y) + \dif{y} \fpart{\phi}{y} (x, y) \label{eq:order2-propag-phi} \\
\fpart{\phi}{x} (x+\dif{x}, y+\dif{y}) &= \fpart{\phi}{x} (x, y) + \dif{x} \left( \fpart{}{x} \fpart{\phi}{x}\right) (x, y) + \dif{y} \left( \fpart{}{y} \fpart{\phi}{x}\right) (x, y) \label{eq:order2-propag-dphidx} \\
\fpart{\phi}{y} (x+\dif{x}, y+\dif{y}) &= \fpart{\phi}{y} (x, y) + \dif{x} \left( \fpart{}{x} \fpart{\phi}{y}\right) (x, y) + \dif{y} \left( \fpart{}{y} \fpart{\phi}{y}\right) (x, y) \label{eq:order2-propag-dphidy}
\end{align}
\end{subequations}
et donc, on peut propager la solution sur tout le plan. Pour que cela fonctionne, il faut que le déterminant de la matrice de \ref{eq:order2-bienpose-edp-dphidxys} ne s'annule pas -- cela définit un \emph{problème bien posé}.

Il reste désormais à déterminer des directions de propagations, $(\dif{x}, \dif{y})$. Considérons donc une telle direction non parallèle à $\Gamma$, qui va nous permettre (du moins, on l'espère) de propager la solution. Les variations de $\fpart{\phi}{x}$ et $\fpart{\phi}{y}$ peuvent être décrites par les différentielles suivantes :
\begin{subequations}
\label{eq:order2-diffdphi-all}
\begin{align}
\fpart{}{x} \left( \fpart{\phi}{x} \right) \dif{x} + \fpart{}{y} \left( \fpart{\phi}{x} \right) \dif{y} &= \dif{\left( \fpart{\phi}{x} \right)} \label{eq:order2-diffdphi-dx} \\
\fpart{}{x} \left( \fpart{\phi}{y} \right) \dif{x} + \fpart{}{y} \left( \fpart{\phi}{y} \right) \dif{y} &= \dif{\left( \fpart{\phi}{y} \right)} \label{eq:order2-diffdphi-dy} \\
\end{align}
\end{subequations}
En y ajoutant l'EDP, on peut former encore un autre système
\begin{equation}
\label{eq:order2-dirpart}
\begin{pmatrix}
A & B & C \\ \dif{x} & \dif{y} & 0 \\ 0 & \dif{x} & \dif{y} \\
\end{pmatrix}
\begin{pmatrix}
\ffpart{\phi}{x} \\[0.5em] \fdpart{\phi}{x}{y} \\[0.5em] \ffpart{\phi}{y} \\
\end{pmatrix}
= \begin{pmatrix}
R \\[0.5em] \dif{\left(\fpart{\phi}{x}\right)} \\[0.5em] \dif{\left(\fpart{\phi}{y}\right)} \\
\end{pmatrix}
\end{equation}
Notons la similarité entre les équations \ref{eq:order1-propag} et \ref{eq:order2-propag-all}, \ref{eq:order1-diffdu} et \ref{eq:order2-diffdphi-all}, et \ref{eq:order1-dirpart} et \ref{eq:order2-dirpart} -- elles expriment les mêmes idées concernant la propagation. De la même manière qu'on a souhaité, dans les EDP d'ordre 1, trouver une direction facile à utiliser, nous allons imposer que le déterminant de ce système soit nul, afin de trouver des directions caractéristiques particulières. Ces directions sont donc solutions de
\[A \dif{y}^2 - B \dif{y} \dif{x} + C \dif{x}^2=0\]
soit, en divisant par $\dif{x}$ :
\footnote{Si $\dif{x}$ est nul, il suffit de diviser par $\dif{y}$ -- cela ne change strictement rien pour la suite.}
\begin{equation}
\label{eq:order2-caractequa}
A \left(\fdif{y}{x}\right)^2 - B \fdif{y}{x} + C = 0
\end{equation}
Il ne reste plus qu'à calculer les deux racines de cette équation. Seulement voilà, elle n'a peut-être pas de solution !

Comme toute équation du second degré, les racines peuvent être réelles et distinctes (auquel cas on a nos caractéristiques), réelles mais confondues (on verra que les caractéristiques dégénèrent) ou carrément imaginaires (aucune caractéristique n'est possible). Tout l'avenir de notre résolution par la méthode des caractéristiques dépend de la valeur de ces solutions, et on entrevoit déjà que dans certains cas, la méthode des caractéristiques est en mauvaise posture...

%TODO d'abord, expliquer chaque type d'EDP, juste la méthode des caractéristiques ; ne pas expliquer comment on les résout, ce sera fait après.

\section{Les différents types d'EDP}

Les trois cas que nous avons relevé ci-dessus ne sont pas anodin, et sont l'objet de théories particulières pour chacune :
\begin{itemize}
	\item Lorsque $B^2-4AC>0$, l'EDP est qualifiée \emph{hyperbolique}. L'équation \ref{eq:order2-caractequa} possède deux solution distinctes, et la méthode des caractéristiques est applicable. Un exemple est l'équation d'onde.
	\item Lorsque $B^2-4AC=0$, l'EDP est dite \emph{parabolique}. L'équation \ref{eq:order2-caractequa} ne possède qu'une seule solution, et la méthode des caractéristiques n'est pas applicable. Un exemple est l'équation de diffusion, qui doit être résolue en partant d'une condition initiale.
	\item Lorsque $B^2-4AC<0$, l'EDP est \emph{elliptique}. Les solutions de \ref{eq:order2-caractequa} sont complexes, la méthode des caractéristiques n'est plus applicable. Un exemple est l'équation de Poisson, qui doit être résolue de manière globale.
\end{itemize}

Les types d'EDP sont ainsi nommés par analogie avec les différentes coniques, et aux conditions permettant de les différencier : l'hyperbole, la parabole et l'ellipse (le cercle en étant un cas particulier).

Le premier type peut être résolu par la méthode des caractéristiques, même si celle-ci est particulièrement lourde. Les deux autres types nécessitent d'autres méthodes ; plus particulièrement, nous allons voir la méthode de séparation des variables pour les résoudre.

\section{EDP hyperboliques : équation d'onde et méthode des caractéristiques}

Dans le cas des EDP hyperboliques, l'équation \ref{eq:order2-caractequa} a deux solutions réelles, et définit donc deux directions caractéristiques. La méthode des caractéristiques est alors utilisable, et on peut propager la solution $u$ de la courbe de Cauchy sur l'ensemble du plan.

Les caractéristiques peuvent être obtenues en intégrant les deux EDO obtenues à partir de la relation caractéristique, d'une manière assez similaire à celle utilisée lors des EDP du 1\ier{} ordre. Ensuite, la valeur de $\fpart{\phi}{x}$ et $\fpart{\phi}{y}$ peuvent être obtenues en intégrant les relations obtenues en remplaçant le terme indépendant de \ref{eq:order2-dirpart} dans une colonne de la matrice. Cela fait donc deux EDO le long de deux caractéristiques. Enfin, la valeur de $\phi$ peut être évaluée à partir des relations \ref{eq:order2-propag-all}.
Nous vous redirigeons vers le syllabus officiel et vers l'APE 3 pour de plus amples informations. %La flemme

%TODO mettre le développement des caractéristiques : copy-paste 1er ordre
%TODO mettre l'équation d'onde et ses caractéristiques, les conditions aux frontières
%TODO mettre d'Alembert : factorisation, solution, onde stationnaire

Il est maintenant possible de définir ce que l'on entend par EDP hyperbolique. Le point commun de toutes ces équations est que l'information de la condition initiale est \emph{transportée} : l'information est transportée le long des caractéristiques à une vitesse finie (la vitesse de l'onde) $c$, et donc il faut un certain temps de propagation, pendant lequel aucune information n'est connue. Une autre propriété est que la régularité et la \emph{smoothness} de la solution est déterminée par la \emph{smoothness} de la condition initiale : une discontinuité de la condition initiale se propagera dans l'ensemble du domaine, exactement comme une onde. Les EDP hyperboliques ont enfin la propriété intéressante que leur problème de Cauchy est bien posé et est résoluble dans les environs de la condition initiale.

Les EDP du premier ordre, de transport ou non, conservatives ou non, et les EDP du second ordre du type équation d'onde, ont les mêmes caractéristiques de propagation d'information à vitesse finie et ont toutes un comportement similaire à une onde transportant de l'information.

\section{EDP paraboliques : équation de diffusion}

%TODO Compléter : présenter l'équation de diffusion, les caractéristiques.
%TODO Domaine infini : solution gaussienne, diffusion de l'intégrale, singularité, Dirac, fonction de Green
%TODO illustrer brièvement la méthode de séparation des variables, pour montrer la diffusion et l'atténuation.

Les EDP paraboliques ont toutes un comportement similaire à celui de l'équation de diffusion. Elles sont causales, doivent être posées en terme de condition initiale, et ont la fâcheuse tendance d'exploser pour des temps négatifs : l'évolution qu'elles décrivent est à un seul sens, et tenter de remonter la solution jusqu'à l'origine du temps donnera des singularités, des valeurs infinies et incohérentes, ou des indéterminations. Dans la direction naturelle d'évolution, elles dispersent la quantité, gomment les singularités, et atténuent les petits sursauts initiaux ; l'information initiale se perd au fur et à mesure de l'évolution du temps, et le phénomène n'est pas réversible.

Ces équations portent donc bien leur nom : la quantité initiale \emph{diffuse} dans l'ensemble du domaine, dans un processus irréversible. C'est tout le contraire des EDP hyperboliques ou de l'équation d'onde, pour laquelle on peut toujours remonter dans le temps et calculer la solution dans l'ensemble du domaine. A noter que les EDP paraboliques possèdent des caractéristiques transportant l'information de l'état initial : néanmoins, elles ne permettent pas de résoudre l'équation.

\section{EDP elliptiques : équation de Laplace et de Poisson}

%TODO présenter Poisson et Laplace, les conditions limites, la relation de compatibilité, la singularité, solution de Poisson, fonction de Green.

Les différentes EDP elliptiques requièrent de résoudre le problème sur un domaine précis, de manière globale : la valeur de $\phi$ en chaque point est influencée par la valeur de $\phi$ aux points environnants. L'information se transmet donc sur l'entièreté de la surface à une vitesse infinie. Les solutions sont toujours régulières et \emph{smooth} : l'équation atténue les irrégularités et les discontinuités dans l'ensemble du domaine, même si les conditions aux frontières sont irrégulières (les frontières gardent leurs irrégularités, mais celles-ci ne se propagent pas). Cette propriété de régularité complète provient directement de l'absence de caractéristiques : les irrégularités ne peuvent se propager que le long de celles-ci, et comme elles sont absentes, il ne peut pas y avoir de discontinuité, ni pour $\phi$ ni pour ses dérivées. Les EDP elliptiques sont donc adaptées à la description de phénomènes statiques, où toute irrégularité a été effacée, par exemple après une diffusion. Elles sont donc à l'opposé des équations hyperboliques.

% Idéalement, la section suivante devrait contenir le développement de la méthode des caractéristiques pour l'équation d'onde. Mais j'ai une grosse flemme de vouloir l'expliquer.
\section{La méthode des caractéristiques appliquée à l'équation d'onde}

Des trois types d'équations du second ordre que nous avons vu, un seul peut être résolu par la méthode des caractéristiques : les EDP hyperboliques, aussi nommées équations d'onde. Ce sont des équations de la forme
\begin{equation*}
A \ffpart{\phi}{x} + B \fdpart{\phi}{x}{y} + C \ffpart{\phi}{y} = R \tag{\ref{eq:order2-genequa}}
\end{equation*}
pour lesquelles $B^2-4AC>0$.

\subsection{Résolution de d'Alembert}

Comme l'a montré la précédente section, résoudre l'équation d'onde par la méthode des caractéristiques est particulièrement lourde, même si elle est intéressante. Ne pourrait-on pas la résoudre plus facilement ?

La réponse est oui, même si elle requiert de l'astuce. Il se fait que l'on peut \emph{factoriser} l'équation d'onde de la façon suivante :
\begin{equation}
\label{eq:order2-ondes-facto}
\left( c \fpart{}{x} - \fpart{}{t} \right) \left( c \fpart{}{x} + \fpart{}{t} \right) \phi = 0
\end{equation}
De quel droit peut-on faire ça ? Du droit que l'on a de considérer les opérateurs de dérivation comme des opérateurs linéaires (un peu spéciaux, mais tout à fait normaux), de considérer que $\fdpart{\phi}{x}{t}=\fdpart{\phi}{t}{x}$, et de notre droit à la rapidité.

Cette réécriture nous informe d'une propriété que l'on avait déjà relevé lors de la méthode des caractéristiques : les quantités $x-ct$ et $x+ct$ sont particulières, elles semblent être conservées. Posons $\xi(x, t) = x-ct$ et $\eta(x, t) = x+ct$, ce qui donne également $x = \frac{\xi+\eta}{2}$ et $t=\frac{\eta-\xi}{2c}$, et calculons un peu les opérateurs de dérivations basés sur ces nouvelles variables :
\begin{subequations}
\label{order2-ondes-dxi-deta}
\begin{align}
\fpart{}{\xi} &= \fpart{x}{\xi} \fpart{}{x} + \fpart{t}{\xi} \fpart{}{t} = \frac{1}{2c} \left( c \fpart{}{x} - \fpart{}{t} \right) \\
\fpart{}{\eta} &= \fpart{x}{\eta} \fpart{}{x} + \fpart{t}{\eta} \fpart{}{t} = \frac{1}{2c} \left( c \fpart{}{x} + \fpart{}{t} \right)
\end{align}
\end{subequations}
On constate que ce sont justement les deux opérateurs résultants de la factorisation, à un facteur $1/2c$ près. On peut donc réécrire l'équation \ref{eq:order2-ondes-facto} sous la \emph{forme canonique}
\begin{equation}
\label{eq:order2-ondes-canonique}
\fpart{}{\xi} \fpart{}{\eta} \phi = \fdpart{\phi}{\xi}{\eta} = 0
\end{equation}

Cette forme canonique, en plus d'être relativement élégante, permet également de simplifier la résolution. En effet, écrivons-là sous cette forme :
\[ \fpart{}{\xi} \left( \fpart{\phi}{\eta} \right) = 0 \]
Cela nous dit que $\fpart{\phi}{\eta}$ est une fonction constante par rapport à $\xi$, vu que sa dérivée par rapport à $\xi$ est nulle. C'est donc, au plus, une fonction de $\eta$, et donc $\fpart{\phi}{\eta} = f_2'(\eta)$, pour une certaine fonction $f_2(\eta)$ encore à définir. En intégrant, on a donc $\phi(\xi, \eta) = f_2(\eta) + K(\xi)$, avec $K$ une constante (par rapport à $\eta$) pouvant dépendre de $\xi$. D'un autre côté, l'équation sous cette forme
\[ \fpart{}{\eta} \left( \fpart{\phi}{\xi} \right) = 0 \]
nous indique que $\fpart{\phi}{\xi}$ est une fonction constante par rapport à $\eta$, et donc est au plus une fonction de $\xi$, et donc $\fpart{\phi}{\xi} = f_1'(\xi)$ pour une fonction $f_1$ encore à définir. En intégrant, on a cette fois $\phi(\xi, \eta) = f_1(\xi) + L(\eta)$, où $L$ est une constante pouvant dépendre de $\eta$. Sauf que les deux fonctions $K$ et $L$ ressemblent étrangement à $f_1$ et $f_2$ respectivement. Disons que ce sont ces fonctions, et notre solution devient
\[ \phi(\xi, \eta) = f_1(\xi) + f_2(\eta) \]
c'est-à-dire
\begin{equation}
\label{order2-ondes-solution-canonique1}
\phi(x, t) = f_1(x-ct) + f_2(x+ct)
\end{equation}

Même si les fonctions $f_1$ et $f_2$ sont pour le moment inconnues, cette solution indique une propriété fondamental de l'équation d'onde en une dimension : une onde est composée de deux parties, définies chacune par leur fonction respective ($f_1$ et $f_2$), qui se propagent chacune dans des directions opposées ; la partie liée à $f_1$ se propage dans la direction des $x$ croissants au fur et à mesure du temps (car $x-ct=$ constante implique que $x$ et $t$ augmentent dans le même sens), et la partie liée à $f_2$ se propage dans la direction des $x$ décroissants. Cela rejoint l'intuition de ce qu'est une onde : elle se propage dans les deux sens de l'espace unidimensionnel, à la même vitesse au signe près.

\section{Avant de conclure}

%TODO mieux conclure
%TODO EDP de type mixte, dont la résolution. Transport-diffusion, Burgers-diffusion, télégraphistes, diffusion-source (Poisson-diffusion)

Avant de passer à la méthode de séparation des variables, ajoutons que les concepts d'équations hyperboliques, paraboliques et elliptiques peuvent être étendus à des espaces à plus de deux dimensions : l'existence ou la non-existence de caractéristiques définit leur catégorie.

La classification peut aussi être faite à partir de l'étude de l'opérateur linéaire qui définit l'équation, en particulier les valeurs propres de la matrice de l'opérateur.
\begin{itemize}
	\item L'EDP est elliptique si ses valeurs propres sont toutes strictement positives ou toutes strictement négatives.
	\item L'EDP est parabolique si les valeurs propres sont toutes strictement positives ou toutes strictement négatives, à part une seule qui vaut zéro.
	\item L'EDP est hyperbolique si toutes les valeurs propres sont strictement positives sauf une qui est strictement négative, ou l'inverse.
	\item L'EDP est dite \emph{ultrahyperbolique} si il y a plus d'une valeur propre qui n'est pas du même signe, et aucune valeur propre n'est négative. Ce type d'équation est très rare, et n'aura droit qu'à une mention honorable dans ces notes.
\end{itemize}

\chapter{L'équation de diffusion}

L'archétype de l'équation du second ordre parabolique est \emph{l'équation de diffusion} :
\begin{equation}
\label{eq:diffusion-genequa}
\end{equation}

\chapter{Méthode de séparation des variables}

\end{document}
